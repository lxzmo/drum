"use strict";(self.webpackChunk_lxzmo_drum=self.webpackChunk_lxzmo_drum||[]).push([[163],{56163:function(ie,B,i){i.r(B),i.d(B,{RIGHT_CLICK_IMAGE_COMMAND:function(){return R},default:function(){return F}});var U=i(48305),_=i.n(U),p=i(81468),G=i(10032),w=i(32785),x=i(21024),e=i(67152),s=i(75271),o=i(52676),I=new Set,R=(0,e.fA)("RIGHT_CLICK_IMAGE_COMMAND");function H(t){if(!I.has(t))throw new Promise(function(g){var d=new Image;d.src=t,d.onload=function(){I.add(t),g(null)},d.onerror=function(){I.add(t)}})}function $(t){var g=t.altText,d=t.className,c=t.imageRef,v=t.src,M=t.width,E=t.height,L=t.maxWidth,D=t.onError;return H(v),(0,o.jsx)("img",{className:d||void 0,src:v,alt:g,ref:c,style:{height:E,maxWidth:L,width:M},onError:D,draggable:"false"})}function k(){return(0,o.jsx)("img",{src:"../../images/image-broken.svg",style:{height:200,opacity:.2,width:200},draggable:"false"})}function F(t){var g=t.src,d=t.altText,c=t.nodeKey,v=t.width,M=t.height,E=t.maxWidth,L=t.resizable,D=(0,p.g)(),V=_()(D,1),n=V[0],h=(0,s.useRef)(null),X=(0,s.useState)(!1),z=_()(X,2),f=z[0],N=z[1],J=(0,s.useState)(null),b=_()(J,2),O=b[0],Q=b[1],Y=(0,G.y)(c),S=_()(Y,3),m=S[0],C=S[1],K=S[2],Z=(0,s.useRef)(null),q=(0,s.useState)(!1),j=_()(q,2),ee=j[0],te=j[1],P=(0,s.useCallback)(function(r){if(m&&(0,e.iO)((0,e.dL)())){var a=r;a.preventDefault();var l=(0,e.gI)(c);if((0,x.$isImageNode)(l))return l.remove(),!0}return!1},[m,c]),T=(0,s.useCallback)(function(r){var a=r;return f?!0:a.target===h.current?(a.shiftKey?C(!m):(K(),C(!0)),!0):!1},[f,m,C,K]),A=(0,s.useCallback)(function(r){n.getEditorState().read(function(){var a=(0,e.dL)(),l=r.target;l.tagName==="IMG"&&(0,e.OP)(a)&&a.getNodes().length===1&&n.dispatchCommand(R,r)})},[n]);(0,s.useEffect)(function(){var r=!0,a=n.getRootElement(),l=(0,w.qV)(n.registerUpdateListener(function(u){var W=u.editorState;r&&Q(W.read(function(){return(0,e.dL)()}))}),n.registerCommand(e.oj,function(u,W){return Z.current=W,!1},e.KB),n.registerCommand(e.Kr,T,e.KB),n.registerCommand(R,T,e.KB),n.registerCommand(e.XI,function(u){return u.target===h.current?(u.preventDefault(),!0):!1},e.KB),n.registerCommand(e.MK,P,e.KB),n.registerCommand(e.aR,P,e.KB));return a==null||a.addEventListener("contextmenu",A),function(){r=!1,l(),a==null||a.removeEventListener("contextmenu",A)}},[K,n,f,m,c,P,T,A,C]);var ae=m&&(0,e.iO)(O)&&!f,y=m||f,ne=function(a,l){setTimeout(function(){N(!1)},200),n.update(function(){var u=(0,e.gI)(c);(0,x.$isImageNode)(u)&&u.setWidthAndHeight(a,l)})},re=function(){N(!0)};return(0,o.jsx)(s.Suspense,{fallback:null,children:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{draggable:ae,children:ee?(0,o.jsx)(k,{}):(0,o.jsx)($,{className:y?"focused ".concat((0,e.iO)(O)?"draggable":""):null,src:g,altText:d,imageRef:h,width:v,height:M,maxWidth:E,onError:function(){return te(!0)}})}),L&&(0,e.iO)(O)&&y&&(0,o.jsx)(x.ImageResizer,{editor:n,imageRef:h,maxWidth:E,onResizeStart:re,onResizeEnd:ne})]})})}}}]);
