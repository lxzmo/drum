"use strict";(self.webpackChunk_lxzmo_drum=self.webpackChunk_lxzmo_drum||[]).push([[627],{47813:function(ft,he,S){S.r(he),S.d(he,{demos:function(){return te}});var J=S(75271),Q=S(24072),te={}},23845:function(ft,he,S){S.r(he),S.d(he,{demos:function(){return Lt}});var J=S(90228),Q=S.n(J),te=S(87999),pe=S.n(te),He=S(75271),gn=S(81861),Lt={"md-components-playground-demo-0":{component:He.memo(He.lazy(pe()(Q()().mark(function vt(){var se,Ye,Ke,Ie,mt,Oe,ht,Mt,Ot,gt,$t,ce,Ht,M,Ve,nt,Je,ye,y,i;return Q()().wrap(function(Qe){for(;;)switch(Qe.prev=Qe.next){case 0:return Qe.next=2,Promise.resolve().then(S.bind(S,21024));case 2:return se=Qe.sent,Ye=se.LexicalComposer,Ke=se.Editor,Ie=se.ImageNode,mt=se.TableCellNode,Oe=se.TableNode,ht=se.TableRowNode,Mt=se.DefaultTheme,Ot=se.ListItemNode,gt=se.ListNode,$t=se.HeadingNode,ce=se.QuoteNode,Ht=se.HorizontalRuleNode,M=se.AutoLinkNode,Ve=se.LinkNode,nt=se.CodeHighlightNode,Je=se.CodeNode,ye=se.MarkNode,y=se.TableBoxNode,i=se.OnChangePlugin,Qe.abrupt("return",{default:function(){var Cn={namespace:"DrumEditor",nodes:[Ie,mt,Oe,ht,Ot,gt,$t,ce,Ht,M,Ve,nt,Je,ye,y],onError:function(rt){throw rt},theme:Mt};return He.createElement("div",null,He.createElement(Ye,{initialConfig:Cn},He.createElement(Ke,null),He.createElement(i,{ignoreHistoryMergeTagChange:!0,ignoreSelectionChange:!0,onChange:function(rt){console.log(JSON.stringify(rt.toJSON()))}})))}});case 23:case"end":return Qe.stop()}},vt)})))),asset:{type:"BLOCK",id:"md-components-playground-demo-0",refAtomIds:[],dependencies:{"index.tsx":{type:"FILE",value:`import {
  LexicalComposer,
  Editor,
  InitialConfigType,
  ImageNode,
  TableCellNode,
  TableNode,
  TableRowNode,
  DefaultTheme,
  ListItemNode,
  ListNode,
  HeadingNode,
  QuoteNode,
  HorizontalRuleNode,
  AutoLinkNode,
  LinkNode,
  CodeHighlightNode,
  CodeNode,
  MarkNode,
  TableBoxNode,
  OnChangePlugin,
} from '@lxzmo/drum';

export default () => {
  const initConfig: InitialConfigType = {
    namespace: 'DrumEditor',
    nodes: [
      ImageNode,
      TableCellNode,
      TableNode,
      TableRowNode,
      ListItemNode,
      ListNode,
      HeadingNode,
      QuoteNode,
      HorizontalRuleNode,
      AutoLinkNode,
      LinkNode,
      CodeHighlightNode,
      CodeNode,
      MarkNode,
      TableBoxNode,
    ],
    onError: (error) => {
      throw error;
    },
    theme: DefaultTheme,
  };
  return (
    <div>
      <LexicalComposer initialConfig={initConfig}>
        <Editor />
        <OnChangePlugin
          ignoreHistoryMergeTagChange={true}
          ignoreSelectionChange={true}
          onChange={(editorState) => {
            console.log(JSON.stringify(editorState.toJSON()));
          }}
        />
      </LexicalComposer>
    </div>
  );
};`},"@lxzmo/drum":{type:"NPM",value:"0.0.4"}},entry:"index.tsx"},context:{"@lxzmo/drum":S(21024)},renderOpts:{compile:function(){var vt=pe()(Q()().mark(function Ye(){var Ke,Ie=arguments;return Q()().wrap(function(Oe){for(;;)switch(Oe.prev=Oe.next){case 0:return Oe.next=2,Promise.all([S.e(379),S.e(268)]).then(S.bind(S,84268));case 2:return Oe.abrupt("return",(Ke=Oe.sent).default.apply(Ke,Ie));case 3:case"end":return Oe.stop()}},Ye)}));function se(){return vt.apply(this,arguments)}return se}()}}}},97059:function(ft,he,S){S.r(he),S.d(he,{demos:function(){return te}});var J=S(75271),Q=S(26037),te={}},21024:function(ft,he,S){S.r(he),S.d(he,{$computeTableMap:function(){return Re},$computeTableMapSkipCellCheck:function(){return Zt},$createAutoLinkNode:function(){return Q.Ol},$createCodeHighlightNode:function(){return J.l9},$createCodeNode:function(){return J.Ol},$createHeadingNode:function(){return ce.V1},$createHorizontalRuleNode:function(){return Ie.Dq},$createImageNode:function(){return en},$createLinkNode:function(){return Q.zV},$createListItemNode:function(){return te.oU},$createListNode:function(){return te.FH},$createMarkNode:function(){return pe.L5},$createQuoteNode:function(){return ce.Z1},$createTableBoxNode:function(){return zt},$createTableCellNode:function(){return Ee},$createTableNode:function(){return Qt},$createTableNodeWithDimensions:function(){return Un},$createTableRowNode:function(){return it},$createTableSelection:function(){return Xt},$deleteTableColumn:function(){return $a},$deleteTableColumn__EXPERIMENTAL:function(){return Ka},$deleteTableRow__EXPERIMENTAL:function(){return Ha},$findCellNode:function(){return Jt},$findTableNode:function(){return lt},$getElementForTableNode:function(){return ro},$getListDepth:function(){return te.Rj},$getMarkIDs:function(){return pe.TX},$getNodeTriplet:function(){return be},$getTableCellNodeFromLexicalNode:function(){return Da},$getTableCellNodeRect:function(){return kn},$getTableColumnIndexFromTableCellNode:function(){return Pa},$getTableNodeFromLexicalNodeOrThrow:function(){return St},$getTableRowIndexFromTableCellNode:function(){return Wn},$getTableRowNodeFromTableCellNodeOrThrow:function(){return Tn},$handleListInsertParagraph:function(){return te.sp},$insertTableColumn:function(){return Fa},$insertTableColumn__EXPERIMENTAL:function(){return _a},$insertTableRow:function(){return Aa},$insertTableRow__EXPERIMENTAL:function(){return Ba},$isAutoLinkNode:function(){return Q.Xp},$isCodeHighlightNode:function(){return J.jZ},$isCodeNode:function(){return J.Pe},$isHeadingNode:function(){return ce.rc},$isHorizontalRuleNode:function(){return Ie.fs},$isImageNode:function(){return ar},$isLinkNode:function(){return Q.Pq},$isListItemNode:function(){return te.QG},$isListNode:function(){return te.I3},$isMarkNode:function(){return pe.dQ},$isQuoteNode:function(){return ce.O},$isTableBoxNode:function(){return Ea},$isTableCellNode:function(){return W},$isTableNode:function(){return fe},$isTableRowNode:function(){return de},$isTableSelection:function(){return le},$removeTableRowAtIndex:function(){return Ia},$toggleLink:function(){return Q.Rf},$unmergeCell:function(){return za},$unwrapMarkNode:function(){return pe.iH},$wrapSelectionInMarkNode:function(){return pe.RT},AutoFocusPlugin:function(){return He.C},AutoLinkNode:function(){return Q.qp},CODE_LANGUAGE_FRIENDLY_NAME_MAP:function(){return J.Wq},CODE_LANGUAGE_MAP:function(){return J.md},CheckListPlugin:function(){return gn.E},ClearEditorPlugin:function(){return Lt.y},CodeActionMenuPlugin:function(){return lr},CodeHighlightNode:function(){return J.o0},CodeHighlightPlugin:function(){return sr},CodeNode:function(){return J.wg},CommentPlugin:function(){return Er},ComponentPickerMenuPlugin:function(){return Rr},ContentEditable:function(){return se.f},DEFAULT_CODE_LANGUAGE:function(){return J.do},DEFAULT_TRANSFORMERS:function(){return ht.j},DRAG_DROP_PASTE:function(){return ce.BD},DefaultTheme:function(){return Cr},DragDropPaste:function(){return Ar},DraggableBlockPlugin:function(){return Br},DraggableBlockPlugin_EXPERIMENTAL:function(){return zr},Dropdown:function(){return pn},DrumTablePlugin:function(){return Ur},Editor:function(){return Ci},FloatingLinkEditorPlugin:function(){return Xr},FloatingTextFormatToolbarPlugin:function(){return ta},HeadingNode:function(){return ce.c2},HistoryPlugin:function(){return Ke.e},HorizontalRuleNode:function(){return Ie.HY},HorizontalRulePlugin:function(){return mt.f},INSERT_CHECK_LIST_COMMAND:function(){return te.d1},INSERT_HORIZONTAL_RULE_COMMAND:function(){return Ie.qL},INSERT_IMAGE_COMMAND:function(){return It},INSERT_INLINE_COMMAND:function(){return nn},INSERT_ORDERED_LIST_COMMAND:function(){return te.B3},INSERT_TABLE_COMMAND:function(){return Ut},INSERT_UNORDERED_LIST_COMMAND:function(){return te.A3},IconButton:function(){return ne},ImageNode:function(){return qt},ImageResizer:function(){return ha},ImagesPlugin:function(){return Pr},InsertImage:function(){return Sn},LexicalComposer:function(){return vt.R},LexicalErrorBoundary:function(){return Ye.g},LinkNode:function(){return Q.GR},ListItemNode:function(){return te.NK},ListNode:function(){return te.EG},ListPlugin:function(){return Oe.B},MarkNode:function(){return pe.jW},MarkdownShortcutPlugin:function(){return ht.r},OnChangePlugin:function(){return Mt.$},PrismTokenizer:function(){return J.k2},QuoteNode:function(){return ce.rT},REMOVE_LIST_COMMAND:function(){return te.GS},RichTextPlugin:function(){return Ot.B},TOGGLE_LINK_COMMAND:function(){return Q.k0},TabFocusPlugin:function(){return aa},TabIndentationPlugin:function(){return gt.u},TableBoxNode:function(){return bn},TableCellHeaderStates:function(){return ie},TableCellNode:function(){return ot},TableCellResizerPlugin:function(){return oa},TableNode:function(){return Tt},TableObserver:function(){return Gn},TablePlugin:function(){return $t.l},TableRowNode:function(){return Wt},ToolbarPlugin:function(){return sa},VerticalDivider:function(){return at},applyTableHandlers:function(){return Jn},createEmptyHistoryState:function(){return Ke.l},eventFiles:function(){return ce.UW},getCodeLanguages:function(){return J.ZB},getDOMCellFromTarget:function(){return Gt},getDefaultCodeLanguage:function(){return J.JK},getEndOfCodeInLine:function(){return J.dS},getFirstCodeNodeOfLine:function(){return J.jS},getLanguageFriendlyName:function(){return J.zP},getLastCodeNodeOfLine:function(){return J._O},getStartOfCodeInLine:function(){return J.nQ},getTableObserverFromTableElement:function(){return Xa},insertList:function(){return te.up},normalizeCodeLang:function(){return J.r0},registerCodeHighlighting:function(){return J.dM},registerRichText:function(){return ce.ML},registerTabIndentation:function(){return gt.x},removeList:function(){return te.J_},toggleLink:function(){return Q.qG}});var J=S(35758),Q=S(20855),te=S(93754),pe=S(904),He=S(179),gn=S(53183),Lt=S(92546),vt=S(74146),se=S(95346),Ye=S(70548),Ke=S(23174),Ie=S(96863),mt=S(19576),Oe=S(8471),ht=S(86084),Mt=S(75527),Ot=S(5161),gt=S(96547),$t=S(88565),ce=S(6665),Ht=S(48305),M=S.n(Ht),Ve=S(18233),nt=S(73378),Je=S(21715),ye=S(37643),y=S(75271),i=S(52676),pn=function(t){var e=t.disabled,n=t.buttonLabel,a=t.options,o=a===void 0?[]:a,l=t.activeOption,f=t.onChange,v=(0,y.useState)(!1),d=M()(v,2),m=d[0],g=d[1],c=function(h){g(h)};return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(Je.Z,{placement:"bottomLeft",overlayInnerStyle:{padding:"0px"},arrow:!1,open:m,onOpenChange:c,content:(0,i.jsx)("div",{className:"drum-dropdown-content",children:o.map(function(u,h){return(0,i.jsxs)("div",{className:"drum-dropdown-item ".concat(l===u.value?"active":""),onClick:function(){g(!1),f==null||f(u.value)},children:[u.label,l===u.value&&(0,i.jsx)(Ve.Z,{})]},h)})}),trigger:"click",children:(0,i.jsxs)(ye.ZP,{disabled:!!e,type:"text",children:[(0,i.jsxs)("div",{style:{width:"80px",textAlign:"left"},children:[" ",n]}),(0,i.jsx)(nt.Z,{})]})})})},Qe=S(26068),Ce=S.n(Qe),Cn=S(67825),xn=S.n(Cn),rt=S(3792),ma=["active","toolTip","placement"],ne=function(t){var e=t.active,n=t.toolTip,a=t.placement,o=xn()(t,ma);return(0,i.jsx)(rt.Z,{title:n,placement:a,children:(0,i.jsx)(ye.ZP,Ce()({className:"icon-button ".concat(e?"active":""),type:"text"},o))})},D=S(32785);function yn(r,t,e){return Math.min(Math.max(r,t),e)}var oe={east:1,north:8,south:2,west:4},ha=function(t){var e=t.onResizeStart,n=t.onResizeEnd,a=t.imageRef,o=t.maxWidth,l=t.editor,f=(0,y.useRef)(null),v=(0,y.useRef)({priority:"",value:"default"}),d=(0,y.useRef)({currentHeight:0,currentWidth:0,direction:0,isResizing:!1,ratio:0,startHeight:0,startWidth:0,startX:0,startY:0}),m=l.getRootElement(),g=o||(m!==null?m.getBoundingClientRect().width-20:100),c=m!==null?m.getBoundingClientRect().height-20:100,u=100,h=100,p=function(w){var x=w===oe.east||w===oe.west,T=w===oe.north||w===oe.south,O=w&oe.north&&w&oe.west||w&oe.south&&w&oe.east,L=x?"ew":T?"ns":O?"nwse":"nesw";m!==null&&m.style.setProperty("cursor","".concat(L,"-resize"),"important"),document.body!==null&&(document.body.style.setProperty("cursor","".concat(L,"-resize"),"important"),v.current.value=document.body.style.getPropertyValue("-webkit-user-select"),v.current.priority=document.body.style.getPropertyPriority("-webkit-user-select"),document.body.style.setProperty("-webkit-user-select","none","important"))},C=function(){m!==null&&m.style.setProperty("cursor","text"),document.body!==null&&(document.body.style.setProperty("cursor","default"),document.body.style.setProperty("-webkit-user-select",v.current.value,v.current.priority))},N=function(w){var x=a.current,T=d.current,O=T.direction&(oe.east|oe.west),L=T.direction&(oe.south|oe.north);if(x!==null&&T.isResizing){var R=(0,D.MZ)(x);if(O&&L){var A=Math.floor(T.startX-w.clientX/R);A=T.direction&oe.east?-A:A;var K=yn(T.startWidth+A,u,g),B=K/T.ratio;x.style.width="".concat(K,"px"),x.style.height="".concat(B,"px"),T.currentHeight=B,T.currentWidth=K}else if(L){var P=Math.floor(T.startY-w.clientY/R);P=T.direction&oe.south?-P:P;var I=yn(T.startHeight+P,h,c);x.style.height="".concat(I,"px"),T.currentHeight=I}else{var U=Math.floor(T.startX-w.clientX/R);U=T.direction&oe.east?-U:U;var X=yn(T.startWidth+U,u,g);x.style.width="".concat(X,"px"),T.currentWidth=X}}},E=function k(){var w=a.current,x=d.current,T=f.current;if(w!==null&&T!==null&&x.isResizing){var O=x.currentWidth,L=x.currentHeight;x.startWidth=0,x.startHeight=0,x.ratio=0,x.startX=0,x.startY=0,x.currentWidth=0,x.currentHeight=0,x.isResizing=!1,T.classList.remove("image-control-wrapper--resizing"),C(),n(O,L),document.removeEventListener("pointermove",N),document.removeEventListener("pointerup",k)}},b=function(w,x){if(l.isEditable()){var T=a.current,O=f.current;if(T!==null&&O!==null){w.preventDefault();var L=T.getBoundingClientRect(),R=L.width,A=L.height,K=(0,D.MZ)(T),B=d.current;B.startWidth=R,B.startHeight=A,B.ratio=R/A,B.currentWidth=R,B.currentHeight=A,B.startX=w.clientX/K,B.startY=w.clientY/K,B.isResizing=!0,B.direction=x,p(x),e(),O.classList.add("image-control-wrapper--resizing"),T.style.height="".concat(A,"px"),T.style.width="".concat(R,"px"),document.addEventListener("pointermove",N),document.addEventListener("pointerup",E)}}};return(0,i.jsxs)("div",{ref:f,children:[(0,i.jsx)("div",{className:"image-resizer image-resizer-n",onPointerDown:function(w){b(w,oe.north)}}),(0,i.jsx)("div",{className:"image-resizer image-resizer-ne",onPointerDown:function(w){b(w,oe.north|oe.east)}}),(0,i.jsx)("div",{className:"image-resizer image-resizer-e",onPointerDown:function(w){b(w,oe.east)}}),(0,i.jsx)("div",{className:"image-resizer image-resizer-se",onPointerDown:function(w){b(w,oe.south|oe.east)}}),(0,i.jsx)("div",{className:"image-resizer image-resizer-s",onPointerDown:function(w){b(w,oe.south)}}),(0,i.jsx)("div",{className:"image-resizer image-resizer-sw",onPointerDown:function(w){b(w,oe.south|oe.west)}}),(0,i.jsx)("div",{className:"image-resizer image-resizer-w",onPointerDown:function(w){b(w,oe.west)}}),(0,i.jsx)("div",{className:"image-resizer image-resizer-nw",onPointerDown:function(w){b(w,oe.north|oe.west)}})]})},ga=S(57488),Sn=function(t){var e=t.disabled,n=t.editor,a=t.children,o=t.onUpload,l=function(d){var m="",g=new FileReader;g.onload=function(){typeof g.result=="string"&&(m=g.result,n.dispatchCommand(It,{src:m,altText:""}))},d!==null&&g.readAsDataURL(d)},f={disabled:!!e,accept:"image/*",showUploadList:!1,beforeUpload:function(d){return l(d),o==null||o(),!1}};return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(ga.Z,Ce()(Ce()({},f),{},{children:a}))})},Kt=S(8212),at=function(){return(0,i.jsx)(Kt.Z,{type:"vertical",style:{height:"auto"}})},pa=S(25298),Ae=S.n(pa),Ca=S(17069),Be=S.n(Ca),xa=S(9504),pt=S.n(xa),ya=S(38836),Ct=S.n(ya),Sa=S(21742),xt=S.n(Sa),ba=S(83136),yt=S.n(ba),s=S(67152),bn=function(r){xt()(e,r);var t=yt()(e);function e(n){return Ae()(this,e),t.call(this,n)}return Be()(e,[{key:"exportJSON",value:function(){return Ce()(Ce()({},pt()(Ct()(e.prototype),"exportJSON",this).call(this)),{},{type:"tablebox",version:1})}},{key:"createDOM",value:function(a,o){var l=document.createElement("div");return(0,D.Yo)(l,a.theme.tableBox),l}},{key:"updateDOM",value:function(){return!1}}],[{key:"getType",value:function(){return"tablebox"}},{key:"clone",value:function(a){return new e(a.__key)}},{key:"importDOM",value:function(){return{div:function(o){return{conversion:Ta,priority:1}}}}},{key:"importJSON",value:function(){return zt()}}]),e}(s.HX);function Ta(r){return{node:zt()}}function zt(){return(0,s.U2)(new bn)}function Ea(r){return r instanceof bn}var wa=S(62657),ge=S.n(wa),ka=S(82092),V=S.n(ka),Hn=/^(\d+(?:\.\d+)?)px$/,Na=75,ie={BOTH:3,COLUMN:2,NO_STATUS:0,ROW:1},ot=function(r){xt()(e,r);var t=yt()(e);function e(){var n,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ie.NO_STATUS,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,l=arguments.length>2?arguments[2]:void 0,f=arguments.length>3?arguments[3]:void 0;return Ae()(this,e),n=t.call(this,f),V()(ge()(n),"__colSpan",void 0),V()(ge()(n),"__rowSpan",void 0),V()(ge()(n),"__headerState",void 0),V()(ge()(n),"__width",void 0),V()(ge()(n),"__backgroundColor",void 0),n.__colSpan=o,n.__rowSpan=1,n.__headerState=a,n.__width=l,n.__backgroundColor=null,n}return Be()(e,[{key:"createDOM",value:function(a){var o=document.createElement(this.getTag());return this.__width&&(o.style.width="".concat(this.__width,"px")),this.__colSpan>1&&(o.colSpan=this.__colSpan),this.__rowSpan>1&&(o.rowSpan=this.__rowSpan),this.__backgroundColor!==null&&(o.style.backgroundColor=this.__backgroundColor),(0,D.Yo)(o,a.theme.tableCell,this.hasHeader()&&a.theme.tableCellHeader),o}},{key:"exportDOM",value:function(a){var o=pt()(Ct()(e.prototype),"exportDOM",this).call(this,a),l=o.element;if(l){var f=l;f.style.border="1px solid black",this.__colSpan>1&&(f.colSpan=this.__colSpan),this.__rowSpan>1&&(f.rowSpan=this.__rowSpan),f.style.width="".concat(this.getWidth()||Na,"px"),f.style.verticalAlign="top",f.style.textAlign="start";var v=this.getBackgroundColor();v!==null?f.style.backgroundColor=v:this.hasHeader()&&(f.style.backgroundColor="#f2f3f5")}return{element:l}}},{key:"exportJSON",value:function(){return Ce()(Ce()({},pt()(Ct()(e.prototype),"exportJSON",this).call(this)),{},{backgroundColor:this.getBackgroundColor(),colSpan:this.__colSpan,headerState:this.__headerState,rowSpan:this.__rowSpan,type:"tablecell",width:this.getWidth()})}},{key:"getColSpan",value:function(){return this.__colSpan}},{key:"setColSpan",value:function(a){return this.getWritable().__colSpan=a,this}},{key:"getRowSpan",value:function(){return this.__rowSpan}},{key:"setRowSpan",value:function(a){return this.getWritable().__rowSpan=a,this}},{key:"getTag",value:function(){return this.hasHeader()?"th":"td"}},{key:"setHeaderStyles",value:function(a){var o=this.getWritable();return o.__headerState=a,this.__headerState}},{key:"getHeaderStyles",value:function(){return this.getLatest().__headerState}},{key:"setWidth",value:function(a){var o=this.getWritable();return o.__width=a,this.__width}},{key:"getWidth",value:function(){return this.getLatest().__width}},{key:"getBackgroundColor",value:function(){return this.getLatest().__backgroundColor}},{key:"setBackgroundColor",value:function(a){this.getWritable().__backgroundColor=a}},{key:"toggleHeaderStyle",value:function(a){var o=this.getWritable();return(o.__headerState&a)===a?o.__headerState-=a:o.__headerState+=a,o}},{key:"hasHeaderState",value:function(a){return(this.getHeaderStyles()&a)===a}},{key:"hasHeader",value:function(){return this.getLatest().__headerState!==ie.NO_STATUS}},{key:"updateDOM",value:function(a){return a.__headerState!==this.__headerState||a.__width!==this.__width||a.__colSpan!==this.__colSpan||a.__rowSpan!==this.__rowSpan||a.__backgroundColor!==this.__backgroundColor}},{key:"isShadowRoot",value:function(){return!0}},{key:"collapseAtStart",value:function(){return!0}},{key:"canBeEmpty",value:function(){return!1}},{key:"canIndent",value:function(){return!1}}],[{key:"getType",value:function(){return"tablecell"}},{key:"clone",value:function(a){var o=new e(a.__headerState,a.__colSpan,a.__width,a.__key);return o.__rowSpan=a.__rowSpan,o.__backgroundColor=a.__backgroundColor,o}},{key:"importDOM",value:function(){return{td:function(o){return{conversion:Kn,priority:0}},th:function(o){return{conversion:Kn,priority:0}}}}},{key:"importJSON",value:function(a){var o=a.colSpan||1,l=a.rowSpan||1,f=Ee(a.headerState,o,a.width||void 0);return f.__rowSpan=l,f.__backgroundColor=a.backgroundColor||null,f}}]),e}(s.HX);function Kn(r){var t=r,e=r.nodeName.toLowerCase(),n=void 0;Hn.test(t.style.width)&&(n=parseFloat(t.style.width));var a=Ee(e==="th"?ie.ROW:ie.NO_STATUS,t.colSpan,n);a.__rowSpan=t.rowSpan;var o=t.style.backgroundColor;o!==""&&(a.__backgroundColor=o);var l=t.style,f=l.textDecoration.split(" "),v=l.fontWeight==="700"||l.fontWeight==="bold",d=f.includes("line-through"),m=l.fontStyle==="italic",g=f.includes("underline");return{after:function(u){return u.length===0&&u.push((0,s.BE)()),u},forChild:function(u,h){if(W(h)&&!(0,s.F7)(u)){var p=(0,s.BE)();return(0,s.A3)(u)&&u.getTextContent()===`
`?null:((0,s.Gg)(u)&&(v&&u.toggleFormat("bold"),d&&u.toggleFormat("strikethrough"),m&&u.toggleFormat("italic"),g&&u.toggleFormat("underline")),p.append(u),p)}return u},node:a}}function Ee(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,e=arguments.length>2?arguments[2]:void 0;return(0,s.U2)(new ot(r,t,e))}function W(r){return r instanceof ot}var Ut=(0,s.fA)("INSERT_TABLE_COMMAND"),La=S(15558),ze=S.n(La),Wt=function(r){xt()(e,r);var t=yt()(e);function e(n,a){var o;return Ae()(this,e),o=t.call(this,a),V()(ge()(o),"__height",void 0),o.__height=n,o}return Be()(e,[{key:"exportJSON",value:function(){return Ce()(Ce()(Ce()({},pt()(Ct()(e.prototype),"exportJSON",this).call(this)),this.getHeight()&&{height:this.getHeight()}),{},{type:"tablerow",version:1})}},{key:"createDOM",value:function(a){var o=document.createElement("tr");return this.__height&&(o.style.height="".concat(this.__height,"px")),(0,D.Yo)(o,a.theme.tableRow),o}},{key:"isShadowRoot",value:function(){return!0}},{key:"setHeight",value:function(a){var o=this.getWritable();return o.__height=a,this.__height}},{key:"getHeight",value:function(){return this.getLatest().__height}},{key:"updateDOM",value:function(a){return a.__height!==this.__height}},{key:"canBeEmpty",value:function(){return!1}},{key:"canIndent",value:function(){return!1}}],[{key:"getType",value:function(){return"tablerow"}},{key:"clone",value:function(a){return new e(a.__height,a.__key)}},{key:"importDOM",value:function(){return{tr:function(o){return{conversion:Ma,priority:0}}}}},{key:"importJSON",value:function(a){return it(a.height)}}]),e}(s.HX);function Ma(r){var t=r,e=void 0;return Hn.test(t.style.height)&&(e=parseFloat(t.style.height)),{node:it(e)}}function it(r){return(0,s.U2)(new Wt(r))}function de(r){return r instanceof Wt}var zn=typeof window!="undefined"&&typeof window.document!="undefined"&&typeof window.document.createElement!="undefined";function q(r,t){if(!r)throw new Error("Internal Lexical error: invariant() is meant to be replaced at compile time. There is no runtime version. Error: "+t)}var Oa=S(335),Xe=S.n(Oa),Ra=S(31759),ja=S.n(Ra);function Un(r,t){for(var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,n=zt(),a=Qt(),o=0;o<r;o++){for(var l=it(),f=0;f<t;f++){var v=ie.NO_STATUS;ja()(e)==="object"?(o===0&&e.rows&&(v|=ie.ROW),f===0&&e.columns&&(v|=ie.COLUMN)):e&&(o===0&&(v|=ie.ROW),f===0&&(v|=ie.COLUMN));var d=Ee(v),m=(0,s.BE)();m.append((0,s.MX)()),d.append(m),l.append(d)}a.append(l)}return n.append(a),n}function Da(r){var t=(0,D.$s)(r,function(e){return W(e)});return W(t)?t:null}function Tn(r){var t=(0,D.$s)(r,function(e){return de(e)});if(de(t))return t;throw new Error("Expected table cell to be inside of table row.")}function St(r){var t=(0,D.$s)(r,function(e){return fe(e)});if(fe(t))return t;throw new Error("Expected table cell to be inside of table.")}function Wn(r){var t=Tn(r),e=St(t);return e.getChildren().findIndex(function(n){return n.is(t)})}function Pa(r){var t=Tn(r);return t.getChildren().findIndex(function(e){return e.is(r)})}function Zn(r,t){var e=St(r),n=e.getCordsFromCellNode(r,t),a=n.x,o=n.y;return{above:e.getCellNodeFromCords(a,o-1,t),below:e.getCellNodeFromCords(a,o+1,t),left:e.getCellNodeFromCords(a-1,o,t),right:e.getCellNodeFromCords(a+1,o,t)}}function Ia(r,t){var e=r.getChildren();if(t>=e.length||t<0)throw new Error("Expected table cell to be inside of table row.");var n=e[t];return n.remove(),r}function Aa(r,t){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,n=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,o=r.getChildren();if(t>=o.length||t<0)throw new Error("Table row target index out of range");var l=o[t];if(de(l))for(var f=0;f<n;f++){for(var v=l.getChildren(),d=v.length,m=it(),g=0;g<d;g++){var c=v[g];q(W(c),"Expected table cell");var u=Zn(c,a),h=u.above,p=u.below,C=ie.NO_STATUS,N=h&&h.getWidth()||p&&p.getWidth()||void 0;(h&&h.hasHeaderState(ie.COLUMN)||p&&p.hasHeaderState(ie.COLUMN))&&(C|=ie.COLUMN);var E=Ee(C,1,N);E.append((0,s.BE)()),m.append(E)}e?l.insertAfter(m):l.insertBefore(m)}else throw new Error("Row before insertion index does not exist.");return r}var En=function(t,e){return t===ie.BOTH||t===e?e:ie.NO_STATUS};function Ba(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,t=(0,s.dL)();q((0,s.OP)(t)||le(t),"Expected a RangeSelection or TableSelection");var e=t.focus.getNode(),n=be(e),a=M()(n,3),o=a[0],l=a[2],f=Re(l,o,o),v=M()(f,2),d=v[0],m=v[1],g=d[0].length,c=m.startRow;if(r){for(var u=c+o.__rowSpan-1,h=d[u],p=it(),C=0;C<g;C++){var N=h[C],E=N.cell,b=N.startRow;if(b+E.__rowSpan-1<=u){var k=h[C].cell,w=k.__headerState,x=En(w,ie.COLUMN);p.append(Ee(x).append((0,s.BE)()))}else E.setRowSpan(E.__rowSpan+1)}var T=l.getChildAtIndex(u);q(de(T),"focusEndRow is not a TableRowNode"),T.insertAfter(p)}else{for(var O=d[c],L=it(),R=0;R<g;R++){var A=O[R],K=A.cell,B=A.startRow;if(B===c){var P=O[R].cell,I=P.__headerState,U=En(I,ie.COLUMN);L.append(Ee(U).append((0,s.BE)()))}else K.setRowSpan(K.__rowSpan+1)}var X=l.getChildAtIndex(c);q(de(X),"focusEndRow is not a TableRowNode"),X.insertBefore(L)}}function Fa(r,t){for(var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,n=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,o=r.getChildren(),l=[],f=0;f<o.length;f++){var v=o[f];if(de(v))for(var d=0;d<n;d++){var m=v.getChildren();if(t>=m.length||t<0)throw new Error("Table column target index out of range");var g=m[t];q(W(g),"Expected table cell");var c=Zn(g,a),u=c.left,h=c.right,p=ie.NO_STATUS;(u&&u.hasHeaderState(ie.ROW)||h&&h.hasHeaderState(ie.ROW))&&(p|=ie.ROW);var C=Ee(p);C.append((0,s.BE)()),l.push({newTableCell:C,targetCell:g})}}return l.forEach(function(N){var E=N.newTableCell,b=N.targetCell;e?b.insertAfter(E):b.insertBefore(E)}),r}function _a(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,t=(0,s.dL)();q((0,s.OP)(t)||le(t),"Expected a RangeSelection or TableSelection");var e=t.anchor.getNode(),n=t.focus.getNode(),a=be(e),o=M()(a,1),l=o[0],f=be(n),v=M()(f,3),d=v[0],m=v[2],g=Re(m,d,l),c=M()(g,3),u=c[0],h=c[1],p=c[2],C=u.length,N=r?Math.max(h.startColumn,p.startColumn):Math.min(h.startColumn,p.startColumn),E=r?N+d.__colSpan-1:N-1,b=m.getFirstChild();q(de(b),"Expected firstTable child to be a row");var k=null;function w(){var F=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ie.NO_STATUS,_=Ee(F).append((0,s.BE)());return k===null&&(k=_),_}var x=b;e:for(var T=0;T<C;T++){if(T!==0){var O=x.getNextSibling();q(de(O),"Expected row nextSibling to be a row"),x=O}var L=u[T],R=L[E<0?0:E].cell.__headerState,A=En(R,ie.ROW);if(E<0){wn(x,w(A));continue}var K=L[E],B=K.cell,P=K.startColumn,I=K.startRow;if(P+B.__colSpan-1<=E){for(var U=B,X=I,H=E;X!==T&&U.__rowSpan>1;)if(H-=B.__colSpan,H>=0){var $=L[H],z=$.cell,j=$.startRow;U=z,X=j}else{x.append(w(A));continue e}U.insertAfter(w(A))}else B.setColSpan(B.__colSpan+1)}k!==null&&Rt(k)}function $a(r,t){for(var e=r.getChildren(),n=0;n<e.length;n++){var a=e[n];if(de(a)){var o=a.getChildren();if(t>=o.length||t<0)throw new Error("Table column target index out of range");o[t].remove()}}return r}function Ha(){var r=(0,s.dL)();q((0,s.OP)(r)||le(r),"Expected a RangeSelection or TableSelection");var t=r.anchor.getNode(),e=r.focus.getNode(),n=be(t),a=M()(n,3),o=a[0],l=a[2],f=be(e),v=M()(f,1),d=v[0],m=Re(l,o,d),g=M()(m,3),c=g[0],u=g[1],h=g[2],p=u.startRow,C=h.startRow,N=C+d.__rowSpan-1;if(c.length===N-p+1){l.remove();return}for(var E=c[0].length,b=c[N+1],k=l.getChildAtIndex(N+1),w=N;w>=p;w--){for(var x=E-1;x>=0;x--){var T=c[w][x],O=T.cell,L=T.startRow,R=T.startColumn;if(R===x&&(w===p&&L<p&&O.setRowSpan(O.__rowSpan-(L-p)),L>=p&&L+O.__rowSpan-1>N))if(O.setRowSpan(O.__rowSpan-(N-L+1)),q(k!==null,"Expected nextRowNode not to be null"),x===0)wn(k,O);else{var A=b[x-1].cell;A.insertAfter(O)}}var K=l.getChildAtIndex(w);q(de(K),"Expected GridNode childAtIndex(%s) to be RowNode",String(w)),K.remove()}if(b!==void 0){var B=b[0].cell;Rt(B)}else{var P=c[p-1],I=P[0].cell;Rt(I)}}function Ka(){var r=(0,s.dL)();q((0,s.OP)(r)||le(r),"Expected a RangeSelection or TableSelection");var t=r.anchor.getNode(),e=r.focus.getNode(),n=be(t),a=M()(n,3),o=a[0],l=a[2],f=be(e),v=M()(f,1),d=v[0],m=Re(l,o,d),g=M()(m,3),c=g[0],u=g[1],h=g[2],p=u.startColumn,C=h.startRow,N=h.startColumn,E=Math.min(p,N),b=Math.max(p+o.__colSpan-1,N+d.__colSpan-1),k=b-E+1,w=c[0].length;if(w===b-E+1){l.selectPrevious(),l.remove();return}for(var x=c.length,T=0;T<x;T++)for(var O=E;O<=b;O++){var L=c[T][O],R=L.cell,A=L.startColumn;if(A<E){if(O===E){var K=E-A;R.setColSpan(R.__colSpan-Math.min(k,R.__colSpan-K))}}else if(A+R.__colSpan-1>b){if(O===b){var B=b-A+1;R.setColSpan(R.__colSpan-B)}}else R.remove()}var P=c[C],I=p>N?P[p+o.__colSpan]:P[N+d.__colSpan];if(I!==void 0){var U=I.cell;Rt(U)}else{var X=N<p?P[N-1]:P[p-1],H=X.cell;Rt(H)}}function Rt(r){var t=r.getFirstDescendant();t==null?r.selectStart():t.getParentOrThrow().selectStart()}function wn(r,t){var e=r.getFirstChild();e!==null?e.insertBefore(t):r.append(t)}function za(){var r=(0,s.dL)();q((0,s.OP)(r)||le(r),"Expected a RangeSelection or TableSelection");var t=r.anchor.getNode(),e=be(t),n=M()(e,3),a=n[0],o=n[1],l=n[2],f=a.__colSpan,v=a.__rowSpan;if(f>1){for(var d=1;d<f;d++)a.insertAfter(Ee(ie.NO_STATUS));a.setColSpan(1)}if(v>1){for(var m=Re(l,a,a),g=M()(m,2),c=g[0],u=g[1],h=u.startColumn,p=u.startRow,C,N=1;N<v;N++){var E=p+N,b=c[E];C=(C||o).getNextSibling(),q(de(C),"Expected row next sibling to be a row");for(var k=null,w=0;w<h;w++){var x=b[w],T=x.cell;x.startRow===E&&(k=T),T.__colSpan>1&&(w+=T.__colSpan-1)}if(k===null)for(var O=0;O<f;O++)wn(C,Ee(ie.NO_STATUS));else for(var L=0;L<f;L++)k.insertAfter(Ee(ie.NO_STATUS))}a.setRowSpan(1)}}function Re(r,t,e){var n=Zt(r,t,e),a=M()(n,3),o=a[0],l=a[1],f=a[2];return q(l!==null,"Anchor not found in Grid"),q(f!==null,"Focus not found in Grid"),[o,l,f]}function Zt(r,t,e){var n=[],a=null,o=null;function l(C,N,E){for(var b={cell:E,startColumn:N,startRow:C},k=E.__rowSpan,w=E.__colSpan,x=0;x<k;x++){n[C+x]===void 0&&(n[C+x]=[]);for(var T=0;T<w;T++)n[C+x][N+T]=b}t!==null&&t.is(E)&&(a=b),e!==null&&e.is(E)&&(o=b)}function f(C,N){return n[C]===void 0||n[C][N]===void 0}for(var v=r.getChildren(),d=0;d<v.length;d++){var m=v[d];q(de(m),"Expected GridNode children to be TableRowNode");var g=m.getChildren(),c=0,u=Xe()(g),h;try{for(u.s();!(h=u.n()).done;){var p=h.value;for(q(W(p),"Expected TableRowNode children to be TableCellNode");!f(d,c);)c++;l(d,c,p),c+=p.__colSpan}}catch(C){u.e(C)}finally{u.f()}}return[n,a,o]}function be(r){var t;if(r instanceof ot)t=r;else if("__type"in r){var e=(0,D.$s)(r,W);q(W(e),"Expected to find a parent TableCellNode"),t=e}else{var n=(0,D.$s)(r.getNode(),W);q(W(n),"Expected to find a parent TableCellNode"),t=n}var a=t.getParent();q(de(a),"Expected TableCellNode to have a parent TableRowNode");var o=a.getParent();return q(fe(o),"Expected TableRowNode to have a parent GridNode"),[t,a,o]}function kn(r){for(var t=be(r),e=M()(t,3),n=e[0],a=e[2],o=a.getChildren(),l=o.length,f=o[0].getChildren().length,v=new Array(l),d=0;d<l;d++)v[d]=new Array(f);for(var m=0;m<l;m++)for(var g=o[m],c=g.getChildren(),u=0,h=0;h<c.length;h++){for(;v[m][u];)u++;for(var p=c[h],C=p.__rowSpan||1,N=p.__colSpan||1,E=0;E<C;E++)for(var b=0;b<N;b++)v[m+E][u+b]=p;if(n===p)return{colSpan:N,columnIndex:u,rowIndex:m,rowSpan:C};u+=N}return null}var Xn=function(){function r(t,e,n){Ae()(this,r),V()(this,"tableKey",void 0),V()(this,"anchor",void 0),V()(this,"focus",void 0),V()(this,"_cachedNodes",void 0),V()(this,"dirty",void 0),this.anchor=e,this.focus=n,e._selection=this,n._selection=this,this._cachedNodes=null,this.dirty=!1,this.tableKey=t}return Be()(r,[{key:"getStartEndPoints",value:function(){return[this.anchor,this.focus]}},{key:"isBackward",value:function(){return this.focus.isBefore(this.anchor)}},{key:"getCachedNodes",value:function(){return this._cachedNodes}},{key:"setCachedNodes",value:function(e){this._cachedNodes=e}},{key:"is",value:function(e){return le(e)?this.tableKey===e.tableKey&&this.anchor.is(e.anchor)&&this.focus.is(e.focus):!1}},{key:"set",value:function(e,n,a){this.dirty=!0,this.tableKey=e,this.anchor.key=n,this.focus.key=a,this._cachedNodes=null}},{key:"clone",value:function(){return new r(this.tableKey,this.anchor,this.focus)}},{key:"isCollapsed",value:function(){return!1}},{key:"extract",value:function(){return this.getNodes()}},{key:"insertRawText",value:function(e){}},{key:"insertText",value:function(){}},{key:"insertNodes",value:function(e){var n=this.focus.getNode();q((0,s.F7)(n),"Expected TableSelection focus to be an ElementNode");var a=(0,s.S9)(n.select(0,n.getChildrenSize()));a.insertNodes(e)}},{key:"getShape",value:function(){var e=(0,s.gI)(this.anchor.key);q(W(e),"Expected TableSelection anchor to be (or a child of) TableCellNode");var n=kn(e);q(n!==null,"getCellRect: expected to find AnchorNode");var a=(0,s.gI)(this.focus.key);q(W(a),"Expected TableSelection focus to be (or a child of) TableCellNode");var o=kn(a);q(o!==null,"getCellRect: expected to find focusCellNode");var l=Math.min(n.columnIndex,o.columnIndex),f=Math.max(n.columnIndex,o.columnIndex),v=Math.min(n.rowIndex,o.rowIndex),d=Math.max(n.rowIndex,o.rowIndex);return{fromX:Math.min(l,f),fromY:Math.min(v,d),toX:Math.max(l,f),toY:Math.max(v,d)}}},{key:"getNodes",value:function(){var e=this._cachedNodes;if(e!==null)return e;var n=this.anchor.getNode(),a=this.focus.getNode(),o=(0,D.$s)(n,W),l=(0,D.$s)(a,W);q(W(o),"Expected TableSelection anchor to be (or a child of) TableCellNode"),q(W(l),"Expected TableSelection focus to be (or a child of) TableCellNode");var f=o.getParent();q(de(f),"Expected anchorCell to have a parent TableRowNode");var v=f.getParent();q(fe(v),"Expected tableNode to have a parent TableNode");var d=l.getParents()[1];if(d!==v){if(v.isParentOf(l)){var g=d.getParent();q(g!=null,"Expected focusCellParent to have a parent"),this.set(this.tableKey,l.getKey(),g.getKey())}else{var m=v.getParent();q(m!=null,"Expected gridParent to have a parent"),this.set(this.tableKey,m.getKey(),l.getKey())}return this.getNodes()}var c=Re(v,o,l),u=M()(c,3),h=u[0],p=u[1],C=u[2],N=Math.min(p.startColumn,C.startColumn),E=Math.min(p.startRow,C.startRow),b=Math.max(p.startColumn+p.cell.__colSpan-1,C.startColumn+C.cell.__colSpan-1),k=Math.max(p.startRow+p.cell.__rowSpan-1,C.startRow+C.cell.__rowSpan-1),w=N,x=E,T=N,O=E;function L(me){var Ne=me.cell,je=me.startColumn,De=me.startRow;N=Math.min(N,je),E=Math.min(E,De),b=Math.max(b,je+Ne.__colSpan-1),k=Math.max(k,De+Ne.__rowSpan-1)}for(;N<w||E<x||b>T||k>O;){if(N<w){for(var R=O-x,A=w-1,K=0;K<=R;K++)L(h[x+K][A]);w=A}if(E<x){for(var B=T-w,P=x-1,I=0;I<=B;I++)L(h[P][w+I]);x=P}if(b>T){for(var U=O-x,X=T+1,H=0;H<=U;H++)L(h[x+H][X]);T=X}if(k>O){for(var $=T-w,z=O+1,j=0;j<=$;j++)L(h[z][w+j]);O=z}}for(var F=[v],_=null,G=E;G<=k;G++)for(var Z=N;Z<=b;Z++){var ee=h[G][Z].cell,re=ee.getParent();q(de(re),"Expected TableCellNode parent to be a TableRowNode"),re!==_&&F.push(re),F.push.apply(F,[ee].concat(ze()(Ua(ee)))),_=re}return(0,s._$)()||(this._cachedNodes=F),F}},{key:"getTextContent",value:function(){for(var e=this.getNodes(),n="",a=0;a<e.length;a++)n+=e[a].getTextContent();return n}}]),r}();function le(r){return r instanceof Xn}function Xt(){var r=(0,s.Qd)("root",0,"element"),t=(0,s.Qd)("root",0,"element");return new Xn("root",r,t)}function Ua(r){for(var t=[],e=[r];e.length>0;){var n=e.pop();q(n!==void 0,"Stack.length > 0; can't be undefined"),(0,s.F7)(n)&&e.unshift.apply(e,ze()(n.getChildren())),n!==r&&t.push(n)}return t}var Gn=function(){function r(t,e){Ae()(this,r),V()(this,"focusX",void 0),V()(this,"focusY",void 0),V()(this,"listenersToRemove",void 0),V()(this,"table",void 0),V()(this,"isHighlightingCells",void 0),V()(this,"anchorX",void 0),V()(this,"anchorY",void 0),V()(this,"tableNodeKey",void 0),V()(this,"anchorCell",void 0),V()(this,"focusCell",void 0),V()(this,"anchorCellNodeKey",void 0),V()(this,"focusCellNodeKey",void 0),V()(this,"editor",void 0),V()(this,"tableSelection",void 0),V()(this,"hasHijackedSelectionStyles",void 0),V()(this,"isSelecting",void 0),this.isHighlightingCells=!1,this.anchorX=-1,this.anchorY=-1,this.focusX=-1,this.focusY=-1,this.listenersToRemove=new Set,this.tableNodeKey=e,this.editor=t,this.table={columns:0,domRows:[],rows:0},this.tableSelection=null,this.anchorCellNodeKey=null,this.focusCellNodeKey=null,this.anchorCell=null,this.focusCell=null,this.hasHijackedSelectionStyles=!1,this.trackTable(),this.isSelecting=!1}return Be()(r,[{key:"getTable",value:function(){return this.table}},{key:"removeListeners",value:function(){Array.from(this.listenersToRemove).forEach(function(e){return e()})}},{key:"trackTable",value:function(){var e=this,n=new MutationObserver(function(a){e.editor.update(function(){for(var o=!1,l=0;l<a.length;l++){var f=a[l],v=f.target,d=v.nodeName;if(d==="TABLE"||d==="TBODY"||d==="THEAD"||d==="TR"){o=!0;break}}if(o){var m=e.editor.getElementByKey(e.tableNodeKey);if(!m)throw new Error("Expected to find TableElement in DOM");e.table=bt(m)}})});this.editor.update(function(){var a=e.editor.getElementByKey(e.tableNodeKey);if(!a)throw new Error("Expected to find TableElement in DOM");e.table=bt(a),n.observe(a,{attributes:!0,childList:!0,subtree:!0})})}},{key:"clearHighlight",value:function(){var e=this,n=this.editor;this.isHighlightingCells=!1,this.anchorX=-1,this.anchorY=-1,this.focusX=-1,this.focusY=-1,this.tableSelection=null,this.anchorCellNodeKey=null,this.focusCellNodeKey=null,this.anchorCell=null,this.focusCell=null,this.hasHijackedSelectionStyles=!1,this.enableHighlightStyle(),n.update(function(){var a=(0,s.gI)(e.tableNodeKey);if(!fe(a))throw new Error("Expected TableNode.");var o=n.getElementByKey(e.tableNodeKey);if(!o)throw new Error("Expected to find TableElement in DOM");var l=bt(o);Yt(n,l,null),(0,s.oq)(null),n.dispatchCommand(s.oj,void 0)})}},{key:"enableHighlightStyle",value:function(){var e=this,n=this.editor;n.update(function(){var a=n.getElementByKey(e.tableNodeKey);if(!a)throw new Error("Expected to find TableElement in DOM");(0,D.PS)(a,n._config.theme.tableSelection),a.classList.remove("disable-selection"),e.hasHijackedSelectionStyles=!1})}},{key:"disableHighlightStyle",value:function(){var e=this,n=this.editor;n.update(function(){var a=n.getElementByKey(e.tableNodeKey);if(!a)throw new Error("Expected to find TableElement in DOM");(0,D.Yo)(a,n._config.theme.tableSelection),e.hasHijackedSelectionStyles=!0})}},{key:"updateTableTableSelection",value:function(e){if(e!==null&&e.tableKey===this.tableNodeKey){var n=this.editor;this.tableSelection=e,this.isHighlightingCells=!0,this.disableHighlightStyle(),Yt(n,this.table,this.tableSelection)}else e==null?this.clearHighlight():(this.tableNodeKey=e.tableKey,this.updateTableTableSelection(e))}},{key:"setFocusCellForSelection",value:function(e){var n=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=this.editor;o.update(function(){var l=(0,s.gI)(n.tableNodeKey);if(!fe(l))throw new Error("Expected TableNode.");var f=o.getElementByKey(n.tableNodeKey);if(!f)throw new Error("Expected to find TableElement in DOM");var v=e.x,d=e.y;if(n.focusCell=e,n.anchorCell!==null){var m=Vn(o._window);m&&m.setBaseAndExtent(n.anchorCell.elem,0,n.focusCell.elem,0)}if(!n.isHighlightingCells&&(n.anchorX!==v||n.anchorY!==d||a))n.isHighlightingCells=!0,n.disableHighlightStyle();else if(v===n.focusX&&d===n.focusY)return;if(n.focusX=v,n.focusY=d,n.isHighlightingCells){var g=(0,s.Xo)(e.elem);if(n.tableSelection!=null&&n.anchorCellNodeKey!=null&&W(g)&&l.is(lt(g))){var c=g.getKey();n.tableSelection=n.tableSelection.clone()||Xt(),n.focusCellNodeKey=c,n.tableSelection.set(n.tableNodeKey,n.anchorCellNodeKey,n.focusCellNodeKey),(0,s.oq)(n.tableSelection),o.dispatchCommand(s.oj,void 0),Yt(o,n.table,n.tableSelection)}}})}},{key:"setAnchorCellForSelection",value:function(e){var n=this;this.isHighlightingCells=!1,this.anchorCell=e,this.anchorX=e.x,this.anchorY=e.y,this.editor.update(function(){var a=(0,s.Xo)(e.elem);if(W(a)){var o=a.getKey();n.tableSelection=n.tableSelection!=null?n.tableSelection.clone():Xt(),n.anchorCellNodeKey=o}})}},{key:"formatCells",value:function(e){var n=this;this.editor.update(function(){var a=(0,s.dL)();le(a)||q(!1,"Expected grid selection");var o=(0,s.vN)(),l=o.anchor,f=o.focus;a.getNodes().forEach(function(v){W(v)&&v.getTextContentSize()!==0&&(l.set(v.getKey(),0,"element"),f.set(v.getKey(),v.getChildrenSize(),"element"),o.formatText(e))}),(0,s.oq)(a),n.editor.dispatchCommand(s.oj,void 0)})}},{key:"clearText",value:function(){var e=this,n=this.editor;n.update(function(){var a=(0,s.gI)(e.tableNodeKey);if(!fe(a))throw new Error("Expected TableNode.");var o=(0,s.dL)();le(o)||q(!1,"Expected grid selection");var l=o.getNodes().filter(W);if(l.length===e.table.columns*e.table.rows){a.selectPrevious(),a.remove();var f=(0,s.Gv)();f.selectStart();return}l.forEach(function(v){if((0,s.F7)(v)){var d=(0,s.BE)(),m=(0,s.MX)();d.append(m),v.append(d),v.getChildren().forEach(function(g){g!==d&&g.remove()})}}),Yt(n,e.table,null),(0,s.oq)(null),n.dispatchCommand(s.oj,void 0)})}}]),r}(),Yn="__lexicalTableSelection",Vn=function(t){return zn?(t||window).getSelection():null},Wa=function(t){return(t.buttons&1)===1};function Jn(r,t,e,n){var a=e.getRootElement();if(a===null)throw new Error("No root element.");var o=new Gn(e,r.getKey()),l=e._window||window;Za(t,o);var f=function(){var u=function p(){o.isSelecting=!1,l.removeEventListener("mouseup",p),l.removeEventListener("mousemove",h)},h=function p(C){setTimeout(function(){if(!Wa(C)&&o.isSelecting){o.isSelecting=!1,l.removeEventListener("mouseup",u),l.removeEventListener("mousemove",p);return}var N=Gt(C.target);N!==null&&(o.anchorX!==N.x||o.anchorY!==N.y)&&(C.preventDefault(),o.setFocusCellForSelection(N))},0)};return{onMouseMove:h,onMouseUp:u}};t.addEventListener("mousedown",function(c){setTimeout(function(){if(c.button===0&&l){var u=Gt(c.target);u!==null&&(st(c),o.setAnchorCellForSelection(u));var h=f(),p=h.onMouseUp,C=h.onMouseMove;o.isSelecting=!0,l.addEventListener("mouseup",p),l.addEventListener("mousemove",C)}},0)});var v=function(u){u.button===0&&e.update(function(){var h=(0,s.dL)(),p=u.target;le(h)&&h.tableKey===o.tableNodeKey&&a.contains(p)&&o.clearHighlight()})};l.addEventListener("mousedown",v),o.listenersToRemove.add(function(){return l.removeEventListener("mousedown",v)}),o.listenersToRemove.add(e.registerCommand(s.Zb,function(c){return jt(e,c,"down",r,o)},s.Eo)),o.listenersToRemove.add(e.registerCommand(s._0,function(c){return jt(e,c,"up",r,o)},s.Eo)),o.listenersToRemove.add(e.registerCommand(s.u$,function(c){return jt(e,c,"backward",r,o)},s.Eo)),o.listenersToRemove.add(e.registerCommand(s.Nm,function(c){return jt(e,c,"forward",r,o)},s.Eo)),o.listenersToRemove.add(e.registerCommand(s.Zq,function(c){var u=(0,s.dL)();if(le(u)){var h=(0,D.$s)(u.focus.getNode(),W);if(W(h))return st(c),h.selectEnd(),!0}return!1},s.Eo));var d=function(u){return function(){var h=(0,s.dL)();if(!qe(h,r))return!1;if(le(h))return o.clearText(),!0;if((0,s.OP)(h)){var p=(0,D.$s)(h.anchor.getNode(),function(T){return W(T)});if(!W(p))return!1;var C=h.anchor.getNode(),N=h.focus.getNode(),E=r.isParentOf(C),b=r.isParentOf(N),k=E&&!b||b&&!E;if(k)return o.clearText(),!0;var w=(0,D.$s)(h.anchor.getNode(),function(T){return(0,s.F7)(T)}),x=w&&(0,D.$s)(w,function(T){return(0,s.F7)(T)&&W(T.getParent())});if(!(0,s.F7)(x)||!(0,s.F7)(w))return!1;if(u===s.n2&&x.getPreviousSibling()===null)return!0}return!1}};[s.cj,s.n2,s.Mt].forEach(function(c){o.listenersToRemove.add(e.registerCommand(c,d(c),s.jw))});var m=function(u){var h=(0,s.dL)();if(!qe(h,r)){var p=h?h.getNodes():null;if(p){var C=p.find(function(b){return fe(b)&&b.getKey()===o.tableNodeKey});if(fe(C)){var N=C.getParent();if(!N)return!1;C.remove()}}return!1}if(le(h))return u.preventDefault(),u.stopPropagation(),o.clearText(),!0;if((0,s.OP)(h)){var E=(0,D.$s)(h.anchor.getNode(),function(b){return W(b)});if(!W(E))return!1}return!1};o.listenersToRemove.add(e.registerCommand(s.aR,m,s.jw)),o.listenersToRemove.add(e.registerCommand(s.MK,m,s.jw)),o.listenersToRemove.add(e.registerCommand(s.Ew,function(c){var u=(0,s.dL)();if(!qe(u,r))return!1;if(le(u))return o.formatCells(c),!0;if((0,s.OP)(u)){var h=(0,D.$s)(u.anchor.getNode(),function(p){return W(p)});if(!W(h))return!1}return!1},s.jw)),o.listenersToRemove.add(e.registerCommand(s.RO,function(c){var u=(0,s.dL)();if(!le(u)||!qe(u,r))return!1;var h=u.anchor.getNode(),p=u.focus.getNode();if(!W(h)||!W(p))return!1;for(var C=Re(r,h,p),N=M()(C,3),E=N[0],b=N[1],k=N[2],w=Math.max(b.startRow,k.startRow),x=Math.max(b.startColumn,k.startColumn),T=Math.min(b.startRow,k.startRow),O=Math.min(b.startColumn,k.startColumn),L=T;L<=w;L++)for(var R=O;R<=x;R++){var A=E[L][R].cell;A.setFormat(c);for(var K=A.getChildren(),B=0;B<K.length;B++){var P=K[B];(0,s.F7)(P)&&!P.isInline()&&P.setFormat(c)}}return!0},s.jw)),o.listenersToRemove.add(e.registerCommand(s.yF,function(c){var u=(0,s.dL)();if(!qe(u,r))return!1;if(le(u))return o.clearHighlight(),!1;if((0,s.OP)(u)){var h=(0,D.$s)(u.anchor.getNode(),function(C){return W(C)});if(!W(h))return!1;if(typeof c=="string"){var p=rr(e,u,r);if(p)return nr(p,r,[(0,s.MX)(c)]),!0}}return!1},s.jw)),n&&o.listenersToRemove.add(e.registerCommand(s.dB,function(c){var u=(0,s.dL)();if(!(0,s.OP)(u)||!u.isCollapsed()||!qe(u,r))return!1;var h=Jt(u.anchor.getNode());if(h===null)return!1;st(c);var p=r.getCordsFromCellNode(h,o.table);return qn(o,r,p.x,p.y,c.shiftKey?"backward":"forward"),!0},s.jw)),o.listenersToRemove.add(e.registerCommand(s.m$,function(c){return r.isSelected()},s.Eo));function g(c){var u=r.getCordsFromCellNode(c,o.table);return r.getDOMCellFromCordsOrThrow(u.x,u.y,o.table)}return o.listenersToRemove.add(e.registerCommand(s.zr,function(c){var u=c.nodes,h=c.selection,p=h.getStartEndPoints(),C=le(h),N=(0,s.OP)(h),E=N&&(0,D.$s)(h.anchor.getNode(),function(xe){return W(xe)})!==null&&(0,D.$s)(h.focus.getNode(),function(xe){return W(xe)})!==null||C;if(u.length!==1||!fe(u[0])||!E||p===null)return!1;var b=M()(p,1),k=b[0],w=u[0],x=w.getChildren(),T=w.getFirstChildOrThrow().getChildrenSize(),O=w.getChildrenSize(),L=(0,D.$s)(k.getNode(),function(xe){return W(xe)}),R=L&&(0,D.$s)(L,function(xe){return de(xe)}),A=R&&(0,D.$s)(R,function(xe){return fe(xe)});if(!W(L)||!de(R)||!fe(A))return!1;for(var K=R.getIndexWithinParent(),B=Math.min(A.getChildrenSize()-1,K+O-1),P=L.getIndexWithinParent(),I=Math.min(R.getChildrenSize()-1,P+T-1),U=Math.min(P,I),X=Math.min(K,B),H=Math.max(P,I),$=Math.max(K,B),z=A.getChildren(),j=0,F,_,G=X;G<=$;G++){var Z=z[G];if(!de(Z))return!1;var ee=x[j];if(!de(ee))return!1;for(var re=Z.getChildren(),me=ee.getChildren(),Ne=0,je=function(){var Me=re[we];if(!W(Me))return{v:!1};var tt=me[Ne];if(!W(tt))return{v:!1};G===X&&we===U?F=Me.getKey():G===$&&we===H&&(_=Me.getKey());var wt=Me.getChildren();tt.getChildren().forEach(function(Fe){if((0,s.Gg)(Fe)){var At=(0,s.BE)();At.append(Fe),Me.append(Fe)}else Me.append(Fe)}),wt.forEach(function(Fe){return Fe.remove()}),Ne++},De,we=U;we<=H;we++)if(De=je(),De)return De.v;j++}if(F&&_){var Le=Xt();Le.set(u[0].getKey(),F,_),(0,s.oq)(Le)}return!0},s.jw)),o.listenersToRemove.add(e.registerCommand(s.oj,function(){var c=(0,s.dL)(),u=(0,s.DN)();if((0,s.OP)(c)){var h=c.anchor,p=c.focus,C=h.getNode(),N=p.getNode(),E=Jt(C),b=Jt(N),k=!!(E&&r.is(lt(E))),w=!!(b&&r.is(lt(b))),x=k!==w,T=k&&w,O=c.isBackward();if(x){var L=c.clone();if(w){var R=Re(r,b,b),A=M()(R,1),K=A[0],B=K[0][0].cell,P=K[K.length-1].at(-1).cell;L.focus.set(O?B.getKey():P.getKey(),O?B.getChildrenSize():P.getChildrenSize(),"element")}else L.anchor.set(r.getParentOrThrow().getKey(),O?r.getIndexWithinParent()+1:r.getIndexWithinParent(),"element");(0,s.oq)(L),Qn(e,o)}else T&&(E.is(b)||(o.setAnchorCellForSelection(g(E)),o.setFocusCellForSelection(g(b),!0),o.isSelecting||setTimeout(function(){var j=f(),F=j.onMouseUp,_=j.onMouseMove;o.isSelecting=!0,l.addEventListener("mouseup",F),l.addEventListener("mousemove",_)},0)))}else if(c&&le(c)&&c.is(u)&&c.tableKey===r.getKey()){var I=Vn(e._window);if(I&&I.anchorNode&&I.focusNode){var U=(0,s.Xo)(I.focusNode),X=U&&!r.is(lt(U)),H=(0,s.Xo)(I.anchorNode),$=H&&r.is(lt(H));if(X&&$&&I.rangeCount>0){var z=(0,s.Ug)(I,e);z&&(z.anchor.set(r.getKey(),c.isBackward()?r.getChildrenSize():0,"element"),I.removeAllRanges(),(0,s.oq)(z))}}}return c&&!c.is(u)&&(le(c)||le(u))&&o.tableSelection&&!o.tableSelection.is(u)?(le(c)&&c.tableKey===o.tableNodeKey?o.updateTableTableSelection(c):!le(c)&&le(u)&&u.tableKey===o.tableNodeKey&&o.updateTableTableSelection(null),!1):(o.hasHijackedSelectionStyles&&!r.isSelected()?Ga(e,o):!o.hasHijackedSelectionStyles&&r.isSelected()&&Qn(e,o),!1)},s.jw)),o.listenersToRemove.add(e.registerCommand(s.K0,function(){var c=(0,s.dL)();if(!(0,s.OP)(c)||!c.isCollapsed()||!qe(c,r))return!1;var u=rr(e,c,r);return u?(nr(u,r),!0):!1},s.jw)),o}function Za(r,t){r[Yn]=t}function Xa(r){return r[Yn]}function Gt(r){for(var t=r;t!=null;){var e=t.nodeName;if(e==="TD"||e==="TH"){var n=t._cell;return n===void 0?null:n}t=t.parentNode}return null}function il(r){var t=r;if(t!==null){var e=t.nodeName;if(e==="SPAN")return!0}return!1}function bt(r){var t=[],e={columns:0,domRows:t,rows:0},n=r.firstChild,a=0,o=0;for(t.length=0;n!=null;){var l=n.nodeName;if(l==="TD"||l==="TH"){var f=n,v={elem:f,hasBackgroundColor:f.style.backgroundColor!=="",highlighted:!1,x:a,y:o};n._cell=v;var d=t[o];d===void 0&&(d=t[o]=[]),d[a]=v}else{var m=n.firstChild;if(m!=null){n=m;continue}}var g=n.nextSibling;if(g!=null){a++,n=g;continue}var c=n.parentNode;if(c!=null){var u=c.nextSibling;if(u==null)break;o++,a=0,n=u}}return e.columns=a+1,e.rows=o+1,e}function Yt(r,t,e){var n=new Set(e?e.getNodes():[]);Nn(t,function(a,o){var l=a.elem;n.has(o)?(a.highlighted=!0,er(r,a)):(a.highlighted=!1,tr(r,a),l.getAttribute("style")||l.removeAttribute("style"))})}function Nn(r,t){for(var e=r.domRows,n=0;n<e.length;n++){var a=e[n];if(a)for(var o=0;o<a.length;o++){var l=a[o];if(l){var f=(0,s.Xo)(l.elem);f!==null&&t(l,f,{x:o,y:n})}}}}function Qn(r,t){t.disableHighlightStyle(),Nn(t.table,function(e){e.highlighted=!0,er(r,e)})}function Ga(r,t){t.enableHighlightStyle(),Nn(t.table,function(e){var n=e.elem;e.highlighted=!1,tr(r,e),n.getAttribute("style")||n.removeAttribute("style")})}var qn=function(t,e,n,a,o){var l=o==="forward";switch(o){case"backward":case"forward":return n!==(l?t.table.columns-1:0)?Vt(e.getCellNodeFromCordsOrThrow(n+(l?1:-1),a,t.table),l):a!==(l?t.table.rows-1:0)?Vt(e.getCellNodeFromCordsOrThrow(l?0:t.table.columns-1,a+(l?1:-1),t.table),l):l?e.selectNext():e.selectPrevious(),!0;case"up":return a!==0?Vt(e.getCellNodeFromCordsOrThrow(n,a-1,t.table),!1):e.selectPrevious(),!0;case"down":return a!==t.table.rows-1?Vt(e.getCellNodeFromCordsOrThrow(n,a+1,t.table),!0):e.selectNext(),!0;default:return!1}},Ya=function(t,e,n,a,o){var l=o==="forward";switch(o){case"backward":case"forward":return n!==(l?t.table.columns-1:0)&&t.setFocusCellForSelection(e.getDOMCellFromCordsOrThrow(n+(l?1:-1),a,t.table)),!0;case"up":return a!==0?(t.setFocusCellForSelection(e.getDOMCellFromCordsOrThrow(n,a-1,t.table)),!0):!1;case"down":return a!==t.table.rows-1?(t.setFocusCellForSelection(e.getDOMCellFromCordsOrThrow(n,a+1,t.table)),!0):!1;default:return!1}};function qe(r,t){if((0,s.OP)(r)||le(r)){var e=t.isParentOf(r.anchor.getNode()),n=t.isParentOf(r.focus.getNode());return e&&n}return!1}function Vt(r,t){t?r.selectStart():r.selectEnd()}var Ln="172,206,247";function er(r,t){var e=t.elem,n=(0,s.Xo)(e);q(W(n),"Expected to find LexicalNode from Table Cell DOMNode");var a=n.getBackgroundColor();a===null?e.style.setProperty("background-color","rgb(".concat(Ln,")")):e.style.setProperty("background-image","linear-gradient(to right, rgba(".concat(Ln,",0.85), rgba(").concat(Ln,",0.85))")),e.style.setProperty("caret-color","transparent")}function tr(r,t){var e=t.elem,n=(0,s.Xo)(e);q(W(n),"Expected to find LexicalNode from Table Cell DOMNode");var a=n.getBackgroundColor();a===null&&e.style.removeProperty("background-color"),e.style.removeProperty("background-image"),e.style.removeProperty("caret-color")}function Jt(r){var t=(0,D.$s)(r,W);return W(t)?t:null}function lt(r){var t=(0,D.$s)(r,fe);return fe(t)?t:null}function jt(r,t,e,n,a){if((e==="up"||e==="down")&&Va(r))return!1;var o=(0,s.dL)();if(!qe(o,n)){if((0,s.OP)(o)){if(o.isCollapsed()&&e==="backward"){var l=o.anchor.type,f=o.anchor.offset;if(l!=="element"&&!(l==="text"&&f===0))return!1;var v=o.anchor.getNode();if(!v)return!1;var d=(0,D.$s)(v,function(dt){return(0,s.F7)(dt)&&!dt.isInline()});if(!d)return!1;var m=d.getPreviousSibling();return!m||!fe(m)?!1:(st(t),m.selectEnd(),!0)}else if(t.shiftKey&&(e==="up"||e==="down")){var g=o.focus.getNode();if((0,s._v)(g)){var c=o.getNodes()[0];if(c){var u=(0,D.$s)(c,W);if(u&&n.isParentOf(u)){var h=n.getFirstDescendant(),p=n.getLastDescendant();if(!h||!p)return!1;var C=be(h),N=M()(C,1),E=N[0],b=be(p),k=M()(b,1),w=k[0],x=n.getCordsFromCellNode(E,a.table),T=n.getCordsFromCellNode(w,a.table),O=n.getDOMCellFromCordsOrThrow(x.x,x.y,a.table),L=n.getDOMCellFromCordsOrThrow(T.x,T.y,a.table);return a.setAnchorCellForSelection(O),a.setFocusCellForSelection(L,!0),!0}}return!1}else{var R=(0,D.$s)(g,function(dt){return(0,s.F7)(dt)&&!dt.isInline()});if(!R)return!1;var A=e==="down"?R.getNextSibling():R.getPreviousSibling();if(fe(A)&&a.tableNodeKey===A.getKey()){var K=A.getFirstDescendant(),B=A.getLastDescendant();if(!K||!B)return!1;var P=be(K),I=M()(P,1),U=I[0],X=be(B),H=M()(X,1),$=H[0],z=o.clone();return z.focus.set((e==="up"?U:$).getKey(),e==="up"?0:$.getChildrenSize(),"element"),(0,s.oq)(z),!0}}}}return!1}if((0,s.OP)(o)&&o.isCollapsed()){var j=o.anchor,F=o.focus,_=(0,D.$s)(j.getNode(),W),G=(0,D.$s)(F.getNode(),W);if(!W(_)||!_.is(G))return!1;var Z=lt(_);if(Z!==n&&Z!=null){var ee=r.getElementByKey(Z.getKey());if(ee!=null)return a.table=bt(ee),jt(r,t,e,Z,a)}if(e==="backward"||e==="forward"){var re=j.type,me=j.offset,Ne=j.getNode();if(!Ne)return!1;var je=o.getNodes();return je.length===1&&(0,s.k$)(je[0])?!1:Ja(re,me,Ne,e)?eo(t,Ne,n,e):!1}var De=r.getElementByKey(_.__key),we=r.getElementByKey(j.key);if(we==null||De==null)return!1;var Le;if(j.type==="element")Le=we.getBoundingClientRect();else{var xe=window.getSelection();if(xe===null||xe.rangeCount===0)return!1;var Me=xe.getRangeAt(0);Le=Me.getBoundingClientRect()}var tt=e==="up"?_.getFirstChild():_.getLastChild();if(tt==null)return!1;var wt=r.getElementByKey(tt.__key);if(wt==null)return!1;var Fe=wt.getBoundingClientRect(),At=e==="up"?Fe.top>Le.top-Le.height:Le.bottom+Le.height>Fe.bottom;if(At){st(t);var ut=n.getCordsFromCellNode(_,a.table);if(t.shiftKey){var ln=n.getDOMCellFromCordsOrThrow(ut.x,ut.y,a.table);a.setAnchorCellForSelection(ln),a.setFocusCellForSelection(ln,!0)}else return qn(a,n,ut.x,ut.y,e);return!0}}else if(le(o)){var An=o.anchor,Bn=o.focus,Bt=(0,D.$s)(An.getNode(),W),ct=(0,D.$s)(Bn.getNode(),W),sn=o.getNodes(),Fn=M()(sn,1),kt=Fn[0],Ft=r.getElementByKey(kt.getKey());if(!W(Bt)||!W(ct)||!fe(kt)||Ft==null)return!1;a.updateTableTableSelection(o);var _t=bt(Ft),un=n.getCordsFromCellNode(Bt,_t),cn=n.getDOMCellFromCordsOrThrow(un.x,un.y,_t);if(a.setAnchorCellForSelection(cn),st(t),t.shiftKey){var dn=n.getCordsFromCellNode(ct,_t);return Ya(a,kt,dn.x,dn.y,e)}else ct.selectEnd();return!0}return!1}function st(r){r.preventDefault(),r.stopImmediatePropagation(),r.stopPropagation()}function Va(r){var t=r.getRootElement();return t?t.hasAttribute("aria-controls")&&t.getAttribute("aria-controls")==="typeahead-menu":!1}function Ja(r,t,e,n){return Qa(r,e,n)||qa(r,t,e,n)}function Qa(r,t,e){return r==="element"&&(e==="backward"?t.getPreviousSibling()===null:t.getNextSibling()===null)}function qa(r,t,e,n){var a=(0,D.$s)(e,function(l){return(0,s.F7)(l)&&!l.isInline()});if(!a)return!1;var o=n==="backward"?t===0:t===e.getTextContentSize();return r==="text"&&o&&(n==="backward"?a.getPreviousSibling()===null:a.getNextSibling()===null)}function eo(r,t,e,n){var a=(0,D.$s)(t,W);if(!W(a))return!1;var o=Re(e,a,a),l=M()(o,2),f=l[0],v=l[1];if(!to(f,v,n))return!1;var d=no(t,n,e);return!d||fe(d)?!1:(st(r),n==="backward"?d.selectEnd():d.selectStart(),!0)}function to(r,t,e){var n=r[0][0],a=r[r.length-1][r[0].length-1],o=t.startColumn,l=t.startRow;return e==="backward"?o===n.startColumn&&l===n.startRow:o===a.startColumn&&l===a.startRow}function no(r,t,e){var n=(0,D.$s)(r,function(o){return(0,s.F7)(o)&&!o.isInline()});if(n){var a=t==="backward"?n.getPreviousSibling():n.getNextSibling();return a&&fe(a)?a:t==="backward"?e.getPreviousSibling():e.getNextSibling()}}function nr(r,t,e){var n=(0,s.BE)();r==="first"?t.insertBefore(n):t.insertAfter(n),n.append.apply(n,ze()(e||[])),n.selectEnd()}function rr(r,t,e){var n=e.getParent();if(n){var a=r.getElementByKey(n.getKey());if(a){var o=window.getSelection();if(!(!o||o.anchorNode!==a)){var l=(0,D.$s)(t.anchor.getNode(),function(E){return W(E)});if(l){var f=(0,D.$s)(l,function(E){return fe(E)});if(!(!fe(f)||!f.is(e))){var v=Re(e,l,l),d=M()(v,2),m=d[0],g=d[1],c=m[0][0],u=m[m.length-1][m[0].length-1],h=g.startRow,p=g.startColumn,C=h===c.startRow&&p===c.startColumn,N=h===u.startRow&&p===u.startColumn;return C?"first":N?"last":void 0}}}}}}var Tt=function(r){xt()(e,r);var t=yt()(e);function e(n){return Ae()(this,e),t.call(this,n)}return Be()(e,[{key:"exportJSON",value:function(){return Ce()(Ce()({},pt()(Ct()(e.prototype),"exportJSON",this).call(this)),{},{type:"table",version:1})}},{key:"createDOM",value:function(a,o){var l=document.createElement("table");return(0,D.Yo)(l,a.theme.table),l}},{key:"updateDOM",value:function(){return!1}},{key:"exportDOM",value:function(a){var o=this;return Ce()(Ce()({},pt()(Ct()(e.prototype),"exportDOM",this).call(this,a)),{},{after:function(f){if(f){var v=f.cloneNode(),d=document.createElement("colgroup"),m=document.createElement("tbody");(0,s.Re)(f)&&m.append.apply(m,ze()(f.children));var g=o.getFirstChildOrThrow();if(!de(g))throw new Error("Expected to find row node.");for(var c=g.getChildrenSize(),u=0;u<c;u++){var h=document.createElement("col");d.append(h)}return v.replaceChildren(d,m),v}}})}},{key:"canBeEmpty",value:function(){return!1}},{key:"isShadowRoot",value:function(){return!0}},{key:"getCordsFromCellNode",value:function(a,o){for(var l=o.rows,f=o.domRows,v=0;v<l;v++){var d=f[v];if(d!=null){var m=d.findIndex(function(g){if(g){var c=g.elem,u=(0,s.Xo)(c);return u===a}});if(m!==-1)return{x:m,y:v}}}throw new Error("Cell not found in table.")}},{key:"getDOMCellFromCords",value:function(a,o,l){var f=l.domRows,v=f[o];if(v==null)return null;var d=v[a];return d==null?null:d}},{key:"getDOMCellFromCordsOrThrow",value:function(a,o,l){var f=this.getDOMCellFromCords(a,o,l);if(!f)throw new Error("Cell not found at cords.");return f}},{key:"getCellNodeFromCords",value:function(a,o,l){var f=this.getDOMCellFromCords(a,o,l);if(f==null)return null;var v=(0,s.Xo)(f.elem);return W(v)?v:null}},{key:"getCellNodeFromCordsOrThrow",value:function(a,o,l){var f=this.getCellNodeFromCords(a,o,l);if(!f)throw new Error("Node at cords not TableCellNode.");return f}},{key:"canSelectBefore",value:function(){return!0}},{key:"canIndent",value:function(){return!1}}],[{key:"getType",value:function(){return"table"}},{key:"clone",value:function(a){return new e(a.__key)}},{key:"importDOM",value:function(){return{table:function(o){return{conversion:ao,priority:1}}}}},{key:"importJSON",value:function(a){return Qt()}}]),e}(s.HX);function ro(r,t){var e=r.getElementByKey(t.getKey());if(e==null)throw new Error("Table Element Not Found");return bt(e)}function ao(r){return{node:Qt()}}function Qt(){return(0,s.U2)(new Tt)}function fe(r){return r instanceof Tt}var oo=y.lazy(function(){return S.e(163).then(S.bind(S,56163))});function io(r){return r.parentElement!==null&&r.parentElement.tagName==="LI"&&r.previousSibling===null&&r.getAttribute("aria-roledescription")==="checkbox"}function lo(r){var t=r;if(t.src.startsWith("file:///")||io(t))return null;var e=t.alt,n=t.src,a=t.width,o=t.height,l=en({altText:e,height:o,src:n,width:a});return{node:l}}var qt=function(r){xt()(e,r);var t=yt()(e);function e(n,a,o,l,f,v,d,m,g){var c;return Ae()(this,e),c=t.call(this,g),V()(ge()(c),"__src",void 0),V()(ge()(c),"__altText",void 0),V()(ge()(c),"__width",void 0),V()(ge()(c),"__height",void 0),V()(ge()(c),"__maxWidth",void 0),V()(ge()(c),"__showCaption",void 0),V()(ge()(c),"__caption",void 0),V()(ge()(c),"__captionsEnabled",void 0),c.__src=n,c.__altText=a,c.__maxWidth=o,c.__width=l||"inherit",c.__height=f||"inherit",c.__showCaption=v||!1,c.__caption=d||(0,s.Jh)({nodes:[]}),c.__captionsEnabled=m||m===void 0,c}return Be()(e,[{key:"exportDOM",value:function(){var a=document.createElement("img");return a.setAttribute("src",this.__src),a.setAttribute("alt",this.__altText),a.setAttribute("width",this.__width.toString()),a.setAttribute("height",this.__height.toString()),{element:a}}},{key:"exportJSON",value:function(){return{altText:this.getAltText(),caption:this.__caption.toJSON(),height:this.__height==="inherit"?0:this.__height,maxWidth:this.__maxWidth,showCaption:this.__showCaption,src:this.getSrc(),type:"image",version:1,width:this.__width==="inherit"?0:this.__width}}},{key:"setWidthAndHeight",value:function(a,o){var l=this.getWritable();l.__width=a,l.__height=o}},{key:"setShowCaption",value:function(a){var o=this.getWritable();o.__showCaption=a}},{key:"createDOM",value:function(a){var o=document.createElement("span"),l=a.theme,f=l.image;return f!==void 0&&(o.className=f),o}},{key:"updateDOM",value:function(){return!1}},{key:"getSrc",value:function(){return this.__src}},{key:"getAltText",value:function(){return this.__altText}},{key:"decorate",value:function(){return(0,i.jsx)(y.Suspense,{fallback:null,children:(0,i.jsx)(oo,{src:this.__src,altText:this.__altText,width:this.__width,height:this.__height,maxWidth:this.__maxWidth,nodeKey:this.getKey(),showCaption:this.__showCaption,caption:this.__caption,captionsEnabled:this.__captionsEnabled,resizable:!0})})}}],[{key:"getType",value:function(){return"image"}},{key:"clone",value:function(a){return new e(a.__src,a.__altText,a.__maxWidth,a.__width,a.__height,a.__showCaption,a.__caption,a.__captionsEnabled,a.__key)}},{key:"importJSON",value:function(a){var o=a.altText,l=a.height,f=a.width,v=a.maxWidth,d=a.caption,m=a.src,g=a.showCaption,c=en({altText:o,height:l,maxWidth:v,showCaption:g,src:m,width:f}),u=c.__caption,h=u.parseEditorState(d.editorState);return h.isEmpty()||u.setEditorState(h),c}},{key:"importDOM",value:function(){return{img:function(){return{conversion:lo,priority:0}}}}}]),e}(s.Ij);function en(r){var t=r.altText,e=r.height,n=r.maxWidth,a=n===void 0?500:n,o=r.captionsEnabled,l=r.src,f=r.width,v=r.showCaption,d=r.caption,m=r.key;return(0,s.U2)(new qt(l,t,a,f,e,v,d,o,m))}function ar(r){return r instanceof qt}var Te=S(81468),Ue=S(30967),so=S(90228),We=S.n(so),uo=S(87999),Dt=S.n(uo),co=S(18486);function or(r,t,e){var n=(0,y.useRef)(null);return n.current=r,(0,y.useMemo)(function(){return(0,co.Z)(function(){n.current&&n.current.apply(n,arguments)},t,{maxWait:e})},[t,e])}var fo=S(96860);function vo(r){var t=r.editor,e=r.getCodeDOMNode,n=(0,y.useState)(!1),a=M()(n,2),o=a[0],l=a[1],f=or(function(){l(!1)},1e3);function v(){return d.apply(this,arguments)}function d(){return d=Dt()(We()().mark(function m(){var g,c;return We()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(g=e(),g){h.next=3;break}return h.abrupt("return");case 3:return c="",t.update(function(){var p=(0,s.Xo)(g);(0,J.Pe)(p)&&(c=p.getTextContent());var C=(0,s.dL)();(0,s.oq)(C)}),h.prev=5,h.next=8,navigator.clipboard.writeText(c);case 8:l(!0),f(),h.next=15;break;case 12:h.prev=12,h.t0=h.catch(5),console.error("Failed to copy: ",h.t0);case 15:case"end":return h.stop()}},m,null,[[5,12]])})),d.apply(this,arguments)}return(0,i.jsx)("button",{type:"button",className:"menu-item",onClick:v,"aria-label":"copy",children:o?(0,i.jsx)(Ve.Z,{}):(0,i.jsx)(rt.Z,{title:"\u590D\u5236\u4EE3\u7801",children:(0,i.jsx)(fo.Z,{})})})}var mo=S(56514),ho=S(43765),ue=(0,ho.Z)({scriptUrl:"//at.alicdn.com/t/c/font_4640692_5a70ze53qjj.js"}),go={css:function(){return Promise.all([S.e(379),S.e(807)]).then(S.t.bind(S,65807,23))},html:function(){return S.e(273).then(S.t.bind(S,63273,23))},js:function(){return S.e(630).then(S.t.bind(S,85630,23))},markdown:function(){return S.e(977).then(S.t.bind(S,66977,23))}};function po(r){return Mn.apply(this,arguments)}function Mn(){return Mn=Dt()(We()().mark(function r(t){var e;return We()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e=go[t],a.next=3,e();case 3:return a.abrupt("return",a.sent);case 4:case"end":return a.stop()}},r)})),Mn.apply(this,arguments)}function Co(){return On.apply(this,arguments)}function On(){return On=Dt()(We()().mark(function r(){var t,e;return We()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,S.e(192).then(S.t.bind(S,77192,23));case 2:return t=a.sent,e=t.format,a.abrupt("return",e);case 5:case"end":return a.stop()}},r)})),On.apply(this,arguments)}var ir={css:{parser:"css"},html:{parser:"html"},js:{parser:"babel"},markdown:{parser:"markdown"}},xo=Object.keys(ir);function yo(r){return xo.includes(r)}function So(r){var t=ir[r];if(!t)throw new Error("CodeActionMenuPlugin: Prettier does not support this language: ".concat(r));return t}function bo(r){var t=r.lang,e=r.editor,n=r.getCodeDOMNode,a=(0,y.useState)(""),o=M()(a,2),l=o[0],f=o[1],v=(0,y.useState)(!1),d=M()(v,2),m=d[0],g=d[1];function c(N){N instanceof Error?(f(N.message),g(!0)):console.error("Unexpected error: ",N)}function u(){return h.apply(this,arguments)}function h(){return h=Dt()(We()().mark(function N(){var E,b,k;return We()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return E=n(),x.prev=1,x.next=4,Co();case 4:return b=x.sent,k=So(t),x.next=8,po(t);case 8:if(x.t0=x.sent,k.plugins=[x.t0],E){x.next=12;break}return x.abrupt("return");case 12:e.update(function(){var T=(0,s.Xo)(E);if((0,J.Pe)(T)){var O=T.getTextContent(),L="";try{L=b(O,k)}catch(A){c(A)}if(L!==""){var R=T.select(0);R.insertText(L),f(""),g(!1)}}}),x.next=18;break;case 15:x.prev=15,x.t1=x.catch(1),c(x.t1);case 18:case"end":return x.stop()}},N,null,[[1,15]])})),h.apply(this,arguments)}function p(){l!==""&&g(!0)}function C(){l!==""&&g(!1)}return(0,i.jsxs)("div",{className:"prettier-wrapper",children:[(0,i.jsx)("button",{type:"button",className:"menu-item",onClick:u,onMouseEnter:p,onMouseLeave:C,"aria-label":"prettier",children:l?(0,i.jsx)(mo.Z,{}):(0,i.jsx)(rt.Z,{title:"\u683C\u5F0F\u5316\u4EE3\u7801",children:(0,i.jsx)(ue,{type:"icon-prettier"})})}),m?(0,i.jsx)("pre",{className:"code-error-tips",children:l}):null]})}function To(r){var t=r.target;if(t&&t instanceof HTMLElement){var e=t.closest("code.default-theme-code"),n=!(e||t.closest("div.code-action-menu-container"));return{codeDOMNode:e,isOutside:n}}else return{codeDOMNode:null,isOutside:!0}}var Eo=8;function wo(r){var t=r.anchorElem,e=(0,Te.g)(),n=M()(e,1),a=n[0],o=(0,y.useState)(""),l=M()(o,2),f=l[0],v=l[1],d=(0,y.useState)(!1),m=M()(d,2),g=m[0],c=m[1],u=(0,y.useState)(!1),h=M()(u,2),p=h[0],C=h[1],N=(0,y.useState)({right:"0",top:"0"}),E=M()(N,2),b=E[0],k=E[1],w=(0,y.useRef)(new Set),x=(0,y.useRef)(null);function T(){return x.current}var O=or(function(A){var K=To(A),B=K.codeDOMNode,P=K.isOutside;if(!P&&B){x.current=B;var I=null,U="";if(a.update(function(){var _=(0,s.Xo)(B);(0,J.Pe)(_)?(I=_,U=I.getLanguage()||"",c(!0)):c(!1)}),I){var X=t.getBoundingClientRect(),H=X.y,$=X.right,z=B.getBoundingClientRect(),j=z.y,F=z.right;v(U),k({right:"".concat($-F+Eo,"px"),top:"".concat(j-H,"px")})}}},50,1e3);(0,y.useEffect)(function(){if(p)return document.addEventListener("mousemove",O),function(){c(!1),O.cancel(),document.removeEventListener("mousemove",O)}},[p,O]),(0,y.useEffect)(function(){return a.registerMutationListener(J.wg,function(A){a.getEditorState().read(function(){var K=Xe()(A),B;try{for(K.s();!(B=K.n()).done;){var P=M()(B.value,2),I=P[0],U=P[1];switch(U){case"created":w.current.add(I);break;case"destroyed":w.current.delete(I);break;default:break}}}catch(X){K.e(X)}finally{K.f()}}),C(w.current.size>0)},{skipInitialization:!1})},[a]);var L=(0,J.r0)(f),R=(0,J.zP)(f);return(0,i.jsx)(i.Fragment,{children:g?(0,i.jsxs)("div",{className:"code-action-menu-container",style:Ce()({},b),children:[(0,i.jsx)("div",{className:"code-highlight-language",children:R}),(0,i.jsx)(vo,{editor:a,getCodeDOMNode:T}),yo(L)?(0,i.jsx)(bo,{editor:a,getCodeDOMNode:T,lang:L}):null]}):null})}function lr(r){var t=r.anchorElem,e=t===void 0?document.body:t;return(0,Ue.createPortal)((0,i.jsx)(wo,{anchorElem:e}),e)}function sr(){var r=(0,Te.g)(),t=M()(r,1),e=t[0];return(0,y.useEffect)(function(){return(0,J.dM)(e)},[e]),null}var ur=S(13319),ko=S(35828),No=S(9062),ve=S(59498),cr=S(41991),Lo=zn?y.useLayoutEffect:y.useEffect,dr=Lo,fr=S(24422),Mo=S(50985),Pt=S(21384);function vr(){return Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,5)}function tn(r,t,e,n,a){return{author:t,content:r,deleted:a===void 0?!1:a,id:e===void 0?vr():e,timeStamp:n===void 0?performance.now():n,type:"comment"}}function mr(r,t,e){return{comments:t,id:e===void 0?vr():e,quote:r,type:"thread"}}function hr(r){return{comments:Array.from(r.comments),id:r.id,quote:r.quote,type:"thread"}}function Oo(r){return{author:r.author,content:"[Deleted Comment]",deleted:!0,id:r.id,timeStamp:r.timeStamp,type:"comment"}}function gr(r){var t=r._changeListeners,e=Xe()(t),n;try{for(e.s();!(n=e.n()).done;){var a=n.value;a()}}catch(o){e.e(o)}finally{e.f()}}var Ro=function(){function r(t){Ae()(this,r),V()(this,"_editor",void 0),V()(this,"_comments",void 0),V()(this,"_changeListeners",void 0),V()(this,"_collabProvider",void 0),this._comments=[],this._editor=t,this._collabProvider=null,this._changeListeners=new Set}return Be()(r,[{key:"isCollaborative",value:function(){return this._collabProvider!==null}},{key:"getComments",value:function(){return this._comments}},{key:"addComment",value:function(e,n,a){var o=this,l=Array.from(this._comments),f=this._getCollabComments();if(n!==void 0&&e.type==="comment")for(var v=function(){var c=l[d];if(c.type==="thread"&&c.id===n.id){var u=hr(c);l.splice(d,1,u);var h=a!==void 0?a:u.comments.length;if(o.isCollaborative()&&f!==null){var p=f.get(d).get("comments");o._withRemoteTransaction(function(){var C=o._createCollabSharedMap(e);p.insert(h,[C])})}return u.comments.splice(h,0,e),1}},d=0;d<l.length&&!v();d++);else{var m=a!==void 0?a:l.length;this.isCollaborative()&&f!==null&&this._withRemoteTransaction(function(){var g=o._createCollabSharedMap(e);f.insert(m,[g])}),l.splice(m,0,e)}this._comments=l,gr(this)}},{key:"deleteCommentOrThread",value:function(e,n){var a=this,o=Array.from(this._comments),l=this._getCollabComments(),f=null;if(n!==void 0)for(var v=function(){var g=o[d];if(g.type==="thread"&&g.id===n.id){var c=hr(g);o.splice(d,1,c);var u=c.comments;if(f=u.indexOf(e),a.isCollaborative()&&l!==null){var h=l.get(d).get("comments");a._withRemoteTransaction(function(){h.delete(f)})}return u.splice(f,1),1}},d=0;d<o.length&&!v();d++);else f=o.indexOf(e),this.isCollaborative()&&l!==null&&this._withRemoteTransaction(function(){l.delete(f)}),o.splice(f,1);return this._comments=o,gr(this),e.type==="comment"?{index:f,markedComment:Oo(e)}:null}},{key:"registerOnChange",value:function(e){var n=this._changeListeners;return n.add(e),function(){n.delete(e)}}},{key:"_withRemoteTransaction",value:function(e){var n=this._collabProvider;if(n!==null){var a=n.doc;a.transact(e,this)}}},{key:"_withLocalTransaction",value:function(e){var n=this._collabProvider;try{this._collabProvider=null,e()}finally{this._collabProvider=n}}},{key:"_getCollabComments",value:function(){var e=this._collabProvider;if(e!==null){var n=e.doc;return n.get("comments",Pt.mJ)}return null}},{key:"_createCollabSharedMap",value:function(e){var n=this,a=new Pt.D5,o=e.type,l=e.id;if(a.set("type",o),a.set("id",l),o==="comment")a.set("author",e.author),a.set("content",e.content),a.set("deleted",e.deleted),a.set("timeStamp",e.timeStamp);else{a.set("quote",e.quote);var f=new Pt.mJ;e.comments.forEach(function(v,d){var m=n._createCollabSharedMap(v);f.insert(d,[m])}),a.set("comments",f)}return a}},{key:"registerCollaboration",value:function(e){var n=this;this._collabProvider=e;var a=this._getCollabComments(),o=function(){e.connect()},l=function(){try{e.disconnect()}catch(m){}},f=this._editor.registerCommand(Mo.MO,function(d){if(o!==void 0&&l!==void 0){var m=d;m?(console.log("Comments connected!"),o()):(console.log("Comments disconnected!"),l())}return!1},s.KB),v=function(m,g){if(g.origin!==n)for(var c=function(){var p=m[u];if(p instanceof Pt.Ev)for(var C=p.target,N=p.delta,E=0,b=function(){var x=N[k],T=x.insert,O=x.retain,L=x.delete,R=C.parent,A=C===a?void 0:R instanceof Pt.D5&&n._comments.find(function(P){return P.id===R.get("id")});if(Array.isArray(T))T.slice().reverse().forEach(function(P){var I=P.get("id"),U=P.get("type"),X=U==="thread"?mr(P.get("quote"),P.get("comments").toArray().map(function(H){return tn(H.get("content"),H.get("author"),H.get("id"),H.get("timeStamp"),H.get("deleted"))}),I):tn(P.get("content"),P.get("author"),I,P.get("timeStamp"),P.get("deleted"));n._withLocalTransaction(function(){n.addComment(X,A,E)})});else if(typeof O=="number")E+=O;else if(typeof L=="number")for(var K=function(){var I=A===void 0||A===!1?n._comments[E]:A.comments[E];n._withLocalTransaction(function(){n.deleteCommentOrThread(I,A)}),E++},B=0;B<L;B++)K()},k=0;k<N.length;k++)b()},u=0;u<m.length;u++)c()};return a===null?function(){return null}:(a.observeDeep(v),o(),function(){a.unobserveDeep(v),f(),n._collabProvider=null})}}]),r}();function jo(r){var t=(0,y.useState)(r.getComments()),e=M()(t,2),n=e[0],a=e[1];return(0,y.useEffect)(function(){return r.registerOnChange(function(){a(r.getComments())})},[r]),n}var Do=S(21653);function pr(){var r=(0,y.useState)(null),t=M()(r,2),e=t[0],n=t[1],a=(0,y.useCallback)(function(){n(null)},[]),o=(0,y.useMemo)(function(){if(e===null)return null;var f=e.title,v=e.content,d=e.closeOnClickOutside;return(0,i.jsx)(Do.Z,{open:e!==null,onClose:a,title:f,maskClosable:d,footer:null,onCancel:a,children:v})},[e,a]),l=(0,y.useCallback)(function(f,v){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;n({closeOnClickOutside:d,content:v(a),title:f})},[a]);return[o,l]}var Cr={autocomplete:"default-theme-autocomplete",characterLimit:"default-theme-character-limit",code:"default-theme-code",codeHighlight:{atrule:"default-theme-token-attr",attr:"default-theme-token-attr",boolean:"default-theme-token-property",builtin:"default-theme-token-selector",cdata:"default-theme-token-comment",char:"default-theme-token-selector",class:"default-theme-token-function","class-name":"default-theme-token-function",comment:"default-theme-token-comment",constant:"default-theme-token-property",deleted:"default-theme-token-property",doctype:"default-theme-token-comment",entity:"default-theme-token-operator",function:"default-theme-token-function",important:"default-theme-token-variable",inserted:"default-theme-token-selector",keyword:"default-theme-token-attr",namespace:"default-theme-token-variable",number:"default-theme-token-property",operator:"default-theme-token-operator",prolog:"default-theme-token-comment",property:"default-theme-token-property",punctuation:"default-theme-token-punctuation",regex:"default-theme-token-variable",selector:"default-theme-token-selector",string:"default-theme-token-selector",symbol:"default-theme-token-property",tag:"default-theme-token-property",url:"default-theme-token-operator",variable:"default-theme-token-variable"},embedBlock:{base:"default-theme-token-embed-block",focus:"default-theme-token-embed-block-focus"},hashtag:"default-theme-token-embed-hashtag",heading:{h1:"default-theme-h1",h2:"default-theme-h2",h3:"default-theme-h3"},hr:"default-theme-hr",image:"editor-image",indent:"default-theme-indent",inlineImage:"inline-editor-image",layoutContainer:"default-theme-layout-container",layoutItem:"default-theme-layout-item",link:"default-theme-link",list:{listitem:"default-theme-list-item",listitemChecked:"default-theme-list-item-checked",listitemUnchecked:"default-theme-list-item-unchecked",nested:{listitem:"default-theme-nested-list-item"},olDepth:["default-theme-ol1","default-theme-ol2","default-theme-ol3","default-theme-ol4","default-theme-ol5"],ul:"default-theme-ul"},ltr:"default-theme-ltr",mark:"default-theme-mark",markOverlap:"default-theme-mark-overlap",paragraph:"default-theme-paragraph",quote:"default-theme-quote",rtl:"default-theme-rtl",tableBox:"default-theme-tablebox",table:"default-theme-table",tableCell:"default-theme-table-cell",tableCellActionButton:"default-theme-table-cell-action-button",tableCellActionButtonContainer:"default-theme-tableC-cell-action-button-container",tableCellEditing:"default-theme-table-cell-editing",tableCellHeader:"default-theme-table-cell-header",tableCellPrimarySelected:"default-theme-table-cell-primary-selected",tableCellResizer:"default-theme-table-cell-resizer",tableCellSelected:"default-theme-table-cell-selected",tableCellSortedIndicator:"default-theme-table-cell-sorted-indicator",tableResizeRuler:"default-theme-table-cell-resize-ruler",tableSelected:"default-theme-table-selected",tableSelection:"default-theme-table-selection",text:{bold:"default-theme-text-bold",code:"default-theme-text-code",italic:"default-theme-text-italic",strikethrough:"default-theme-text-strikethrough",subscript:"default-theme-text-subscript",superscript:"default-theme-text-superscript",underline:"default-theme-text-underline",underlineStrikethrough:"default-theme-text-underline-strikethrough"}},Po=Ce()(Ce()({},Cr),{},{paragraph:"comment-editor-theme-paragraph"}),Io=Po,nn=(0,s.fA)("INSERT_INLINE_COMMAND");function Ao(r){var t=r.anchorKey,e=r.editor,n=r.onAddComment,a=(0,y.useRef)(null),o=(0,y.useCallback)(function(){var l=a.current,f=e.getRootElement(),v=e.getElementByKey(t);if(l!==null&&f!==null&&v!==null){var d=f.getBoundingClientRect(),m=d.right,g=v.getBoundingClientRect(),c=g.top;l.style.left="".concat(m-20,"px"),l.style.top="".concat(c-30,"px")}},[t,e]);return(0,y.useEffect)(function(){return window.addEventListener("resize",o),function(){window.removeEventListener("resize",o)}},[e,o]),dr(function(){o()},[t,e,o]),(0,i.jsx)("div",{className:"comment-plugin-add-comment-box",ref:a,children:(0,i.jsx)("button",{type:"button",className:"comment-plugin-add-comment-box-button",onClick:n,children:(0,i.jsx)(fr.Z,{})})})}function Bo(r){var t=r.onEscape,e=(0,Te.g)(),n=M()(e,1),a=n[0];return(0,y.useEffect)(function(){return a.registerCommand(s.Zq,function(o){return t(o)},2)},[a,t]),null}function xr(r){var t=r.className,e=r.autoFocus,n=r.onEscape,a=r.onChange,o=r.editorRef,l=r.placeholder,f=l===void 0?"\u8F93\u5165\u8BC4\u8BBA":l,v={namespace:"Commenting",nodes:[],onError:function(m){throw m},theme:Io};return(0,i.jsx)(vt.R,{initialConfig:v,children:(0,i.jsxs)("div",{className:"comment-plugin-comment-input-box-editor-container",children:[(0,i.jsx)(No.W,{contentEditable:(0,i.jsx)(se.f,{"aria-placeholder":f,placeholder:(0,i.jsx)("div",{className:"content-editable-placeholder",children:f}),className:t}),ErrorBoundary:Ye.g}),(0,i.jsx)(Mt.$,{onChange:a}),(0,i.jsx)(Ke.e,{}),e!==!1&&(0,i.jsx)(He.C,{}),(0,i.jsx)(Bo,{onEscape:n}),(0,i.jsx)(Lt.y,{}),o!==void 0&&(0,i.jsx)(ko.n,{editorRef:o})]})})}function yr(r,t){return(0,y.useCallback)(function(e,n){e.read(function(){r((0,cr.Rh)()),t(!(0,cr.zA)(n.isComposing(),!0))})},[t,r])}function Sr(){var r=(0,ur.Z)(),t=r.yjsDocMap,e=r.name;return t.has("comments")?e:"\u7528\u6237"}function Fo(r){var t=r.editor,e=r.cancelAddComment,n=r.submitAddComment,a=(0,y.useState)(""),o=M()(a,2),l=o[0],f=o[1],v=(0,y.useState)(!1),d=M()(v,2),m=d[0],g=d[1],c=(0,y.useRef)(null),u=(0,y.useMemo)(function(){return{container:document.createElement("div"),elements:[]}},[]),h=(0,y.useRef)(null),p=Sr(),C=(0,y.useCallback)(function(){t.getEditorState().read(function(){var k=(0,s.dL)();if((0,s.OP)(k)){h.current=k.clone();var w=k.anchor,x=k.focus,T=(0,ve.XM)(t,w.getNode(),w.offset,x.getNode(),x.offset),O=c.current;if(T!==null&&O!==null){var L=T.getBoundingClientRect(),R=L.left,A=L.bottom,K=L.width,B=(0,ve.FN)(t,T),P=B.length===1?R+K/2-125:R-125;P<10&&(P=10),O.style.left="".concat(P,"px"),O.style.top="".concat(A+20+(window.pageYOffset||document.documentElement.scrollTop),"px");for(var I=B.length,U=u.container,X=u.elements,H=X.length,$=0;$<I;$++){var z=B[$],j=X[$];j===void 0&&(j=document.createElement("span"),X[$]=j,U.appendChild(j));var F="255, 212, 0",_="position:absolute;top:".concat(z.top+(window.pageYOffset||document.documentElement.scrollTop),"px;left:").concat(z.left,"px;height:").concat(z.height,"px;width:").concat(z.width,"px;background-color:rgba(").concat(F,", 0.3);pointer-events:none;z-index:5;");j.style.cssText=_}for(var G=H-1;G>=I;G--){var Z=X[G];U.removeChild(Z),X.pop()}}}})},[t,u]);dr(function(){C();var k=u.container,w=document.body;if(w!==null)return w.appendChild(k),function(){w.removeChild(k)}},[u.container,C]),(0,y.useEffect)(function(){return window.addEventListener("resize",C),function(){window.removeEventListener("resize",C)}},[C]);var N=function(w){return w.preventDefault(),e(),!0},E=function(){if(m){var w=t.getEditorState().read(function(){var x=h.current;return x?x.getTextContent():""});w.length>100&&(w=w.slice(0,99)+"\u2026"),n(mr(w,[tn(l,p)]),!0,void 0,h.current),h.current=null}},b=yr(f,g);return(0,i.jsxs)("div",{className:"comment-plugin-comment-input-box",ref:c,children:[(0,i.jsx)(xr,{className:"comment-plugin-comment-input-box-editor",onEscape:N,onChange:b}),(0,i.jsxs)("div",{className:"comment-plugin-comment-input-box-buttons",children:[(0,i.jsx)(ye.ZP,{onClick:e,children:"\u53D6\u6D88"}),(0,i.jsx)(ye.ZP,{type:"primary",onClick:E,disabled:!m,children:"\u8BC4\u8BBA"})]})]})}function _o(r){var t=r.submitAddComment,e=r.thread,n=r.placeholder,a=(0,y.useState)(""),o=M()(a,2),l=o[0],f=o[1],v=(0,y.useState)(!1),d=M()(v,2),m=d[0],g=d[1],c=(0,y.useRef)(null),u=Sr(),h=yr(f,g),p=function(){if(m){t(tn(l,u),!1,e);var N=c.current;N!==null&&N.dispatchCommand(s.BM,void 0)}};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(xr,{className:"comment-plugin-comments-panel-editor",autoFocus:!1,onEscape:function(){return!0},onChange:h,editorRef:c,placeholder:n}),(0,i.jsx)(ye.ZP,{className:"comment-plugin-comments-panel-send-button",onClick:p,disabled:!m,type:"text",children:(0,i.jsx)("i",{className:"send"})})]})}function br(r){var t=r.commentOrThread,e=r.deleteCommentOrThread,n=r.onClose,a=r.thread,o=a===void 0?void 0:a;return(0,i.jsxs)(i.Fragment,{children:["\u786E\u5B9A\u5220\u9664\u6B64\u7EBF\u7A0B\u6240\u6709\u8BC4\u8BBA\u5417?",(0,i.jsxs)("div",{className:"modal-content",children:[(0,i.jsx)(ye.ZP,{onClick:function(){e(t,o),n()},children:"\u5220\u9664"}),(0,i.jsx)(ye.ZP,{onClick:function(){n()},children:"\u53D6\u6D88"})]})]})}function Tr(r){var t=r.comment,e=r.deleteComment,n=r.thread,a=r.rtf,o=Math.round((t.timeStamp-performance.now())/1e3),l=Math.round(o/60),f=pr(),v=M()(f,2),d=v[0],m=v[1];return(0,i.jsxs)("li",{className:"comment-plugin-comments-panel-list-comment",children:[(0,i.jsxs)("div",{className:"comment-plugin-comments-panel-list-details",children:[(0,i.jsx)("span",{className:"comment-plugin-comments-panel-list-comment-author",children:t.author}),(0,i.jsxs)("span",{className:"comment-plugin-comments-panel-list-comment-time",children:["\xB7 ",o>-10?"\u521A\u521A":a.format(l,"minute")]})]}),(0,i.jsx)("p",{className:t.deleted?"comment-plugin-comments-panel-deleted-comment":"",children:t.content}),!t.deleted&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(ye.ZP,{type:"text",onClick:function(){m("\u5220\u9664\u8BC4\u8BBA",function(c){return(0,i.jsx)(br,{commentOrThread:t,deleteCommentOrThread:e,thread:n,onClose:c})})},className:"comment-plugin-comments-panel-list-delete-button",children:(0,i.jsx)("i",{className:"delete"})}),d]})]})}function $o(r){var t=r.activeIDs,e=r.comments,n=r.deleteCommentOrThread,a=r.listRef,o=r.submitAddComment,l=r.markNodeMap,f=(0,Te.g)(),v=M()(f,1),d=v[0],m=(0,y.useState)(0),g=M()(m,2),c=g[0],u=g[1],h=pr(),p=M()(h,2),C=p[0],N=p[1],E=(0,y.useMemo)(function(){return new Intl.RelativeTimeFormat("en",{localeMatcher:"best fit",numeric:"auto",style:"short"})},[]);return(0,y.useEffect)(function(){var b=setTimeout(function(){u(c+1)},1e4);return function(){clearTimeout(b)}},[c]),(0,i.jsx)("ul",{className:"comment-plugin-comments-panel-list",ref:a,children:e.map(function(b){var k=b.id;if(b.type==="thread"){var w=function(){var T=l.get(k);if(T!==void 0&&(t===null||t.indexOf(k)===-1)){var O=document.activeElement;d.update(function(){var L=Array.from(T)[0],R=(0,s.gI)(L);(0,pe.dQ)(R)&&R.selectStart()},{onUpdate:function(){O!==null&&O.focus()}})}};return(0,i.jsxs)("li",{onClick:w,className:"comment-plugin-comments-panel-list-thread ".concat(l.has(k)?"interactive":""," ").concat(t.indexOf(k)===-1?"":"active"),children:[(0,i.jsxs)("div",{className:"comment-plugin-comments-panel-list-thread-quote-box",children:[(0,i.jsxs)("blockquote",{className:"comment-plugin-comments-panel-list-thread-quote",children:["> ",(0,i.jsx)("span",{children:b.quote})]}),(0,i.jsx)(ye.ZP,{onClick:function(){N("\u5220\u9664\u6B64\u7EBF\u7A0B\u6240\u6709\u8BC4\u8BBA",function(T){return(0,i.jsx)(br,{commentOrThread:b,deleteCommentOrThread:n,onClose:T})})},type:"text",className:"comment-plugin-comments-panel-list-delete-button",children:(0,i.jsx)("i",{className:"delete"})}),C]}),(0,i.jsx)("ul",{className:"comment-plugin-comments-panel-list-thread-comments",children:b.comments.map(function(x){return(0,i.jsx)(Tr,{comment:x,deleteComment:n,thread:b,rtf:E},x.id)})}),(0,i.jsx)("div",{className:"comment-plugin-comments-panel-list-thread-editor",children:(0,i.jsx)(_o,{submitAddComment:o,thread:b,placeholder:"\u56DE\u590D\u8BC4\u8BBA"})})]},k)}return(0,i.jsx)(Tr,{comment:b,deleteComment:n,rtf:E},k)})})}function Ho(r){var t=r.activeIDs,e=r.deleteCommentOrThread,n=r.comments,a=r.submitAddComment,o=r.markNodeMap,l=(0,y.useRef)(null),f=n.length===0;return(0,i.jsxs)("div",{className:"comment-plugin-comments-panel",children:[(0,i.jsx)("h2",{className:"comment-plugin-comments-panel-heading",children:"\u8BC4\u8BBA"}),f?(0,i.jsx)("div",{className:"comment-plugin-comments-panel-empty",children:"\u6682\u65E0\u8BC4\u8BBA"}):(0,i.jsx)($o,{activeIDs:t,comments:n,deleteCommentOrThread:e,listRef:l,submitAddComment:a,markNodeMap:o})]})}function Er(r){var t=r.providerFactory,e=(0,ur.Z)(),n=(0,Te.g)(),a=M()(n,1),o=a[0],l=(0,y.useMemo)(function(){return new Ro(o)},[o]),f=jo(l),v=(0,y.useMemo)(function(){return new Map},[]),d=(0,y.useState)(),m=M()(d,2),g=m[0],c=m[1],u=(0,y.useState)([]),h=M()(u,2),p=h[0],C=h[1],N=(0,y.useState)(!1),E=M()(N,2),b=E[0],k=E[1],w=(0,y.useState)(!1),x=M()(w,2),T=x[0],O=x[1],L=e.yjsDocMap;(0,y.useEffect)(function(){if(t){var P=t("comments",L);return l.registerCollaboration(P)}},[l,t,L]);var R=(0,y.useCallback)(function(){o.update(function(){var P=(0,s.dL)();P!==null&&(P.dirty=!0)}),k(!1)},[o]),A=(0,y.useCallback)(function(P,I){if(P.type==="comment"){var U=l.deleteCommentOrThread(P,I);if(!U)return;var X=U.markedComment,H=U.index;l.addComment(X,I,H)}else{l.deleteCommentOrThread(P);var $=I!==void 0?I.id:P.id,z=v.get($);z!==void 0&&setTimeout(function(){o.update(function(){var j=Xe()(z),F;try{for(j.s();!(F=j.n()).done;){var _=F.value,G=(0,s.gI)(_);(0,pe.dQ)(G)&&(G.deleteID($),G.getIDs().length===0&&(0,pe.iH)(G))}}catch(Z){j.e(Z)}finally{j.f()}})})}},[l,o,v]),K=(0,y.useCallback)(function(P,I,U,X){l.addComment(P,U),I&&(o.update(function(){if((0,s.OP)(X)){var H=X.isBackward(),$=P.id;(0,pe.RT)(X,H,$)}}),k(!1))},[l,o]);(0,y.useEffect)(function(){for(var P=[],I=0;I<p.length;I++){var U=p[I],X=v.get(U);if(X!==void 0){var H=Xe()(X),$;try{for(H.s();!($=H.n()).done;){var z=$.value,j=o.getElementByKey(z);j!==null&&(j.classList.add("selected"),P.push(j),O(!0))}}catch(F){H.e(F)}finally{H.f()}}}return function(){for(var F=0;F<P.length;F++){var _=P[F];_.classList.remove("selected")}}},[p,o,v]),(0,y.useEffect)(function(){var P=new Map;return(0,D.qV)((0,D.Ho)(o,pe.jW,function(I){return(0,pe.L5)(I.getIDs())},function(I,U){var X=I.getIDs();X.forEach(function(H){U.addID(H)})}),o.registerMutationListener(pe.jW,function(I){o.getEditorState().read(function(){var U=Xe()(I),X;try{for(U.s();!(X=U.n()).done;){var H=M()(X.value,2),$=H[0],z=H[1],j=(0,s.gI)($),F=[];z==="destroyed"?F=P.get($)||[]:(0,pe.dQ)(j)&&(F=j.getIDs());for(var _=0;_<F.length;_++){var G=F[_],Z=v.get(G);P.set($,F),z==="destroyed"?Z!==void 0&&(Z.delete($),Z.size===0&&v.delete(G)):(Z===void 0&&(Z=new Set,v.set(G,Z)),Z.has($)||Z.add($))}}}catch(ee){U.e(ee)}finally{U.f()}})},{skipInitialization:!1}),o.registerUpdateListener(function(I){var U=I.editorState,X=I.tags;U.read(function(){var H=(0,s.dL)(),$=!1,z=!1;if((0,s.OP)(H)){var j=H.anchor.getNode();if((0,s.Gg)(j)){var F=(0,pe.TX)(j,H.anchor.offset);F!==null&&(C(F),$=!0),H.isCollapsed()||(c(j.getKey()),z=!0)}}$||C(function(_){return _.length===0?_:[]}),z||c(null),!X.has("collaboration")&&(0,s.OP)(H)&&k(!1)})}),o.registerCommand(nn,function(){var I=window.getSelection();return I!==null&&I.removeAllRanges(),k(!0),!0},s.VN))},[o,v]);var B=function(){o.dispatchCommand(nn,void 0)};return(0,i.jsxs)(i.Fragment,{children:[b&&(0,Ue.createPortal)((0,i.jsx)(Fo,{editor:o,cancelAddComment:R,submitAddComment:K}),document.body),g!=null&&!b&&(0,Ue.createPortal)((0,i.jsx)(Ao,{anchorKey:g,editor:o,onAddComment:B}),document.body),(0,Ue.createPortal)((0,i.jsx)(ye.ZP,{className:"comment-plugin-show-comments-button ".concat(T?"active":""),onClick:function(){return O(!T)},title:T?"Hide Comments":"Show Comments",children:(0,i.jsx)("i",{className:"comments"})}),document.body),T&&(0,Ue.createPortal)((0,i.jsx)(Ho,{comments:f,submitAddComment:K,deleteCommentOrThread:A,activeIDs:p,markNodeMap:v}),document.body)]})}var wr=S(21375),kr=S(84959),Nr=S(23795),Lr=S(55663),Mr=S(2780),Ko=S(64203),Rn=S(28690),zo=function(){var t=[];return Array.from({length:9}).forEach(function(e,n){Array.from({length:9}).forEach(function(a,o){t.push({x:n+1,y:o+1})})}),t},Or=function(t){var e=t.editor,n=t.placement,a=t.children,o=t.disabled,l=t.trigger,f=l===void 0?"click":l,v=t.onClick,d=(0,y.useState)(!1),m=M()(d,2),g=m[0],c=m[1],u=function(T){c(T)},h=y.useState(null),p=M()(h,2),C=p[0],N=p[1],E=y.useState(zo()),b=M()(E,1),k=b[0],w=function(T){v==null||v(),e.dispatchCommand(Ut,{columns:String(T.y),rows:String(T.x),includeHeaders:!1}),c(!1)};return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(Je.Z,{arrow:!1,open:g,onOpenChange:u,trigger:f,placement:n!=null?n:"bottomLeft",content:(0,i.jsx)("div",{onMouseLeave:function(){N(null)},className:"drum-insert-table-selected-box",onClick:function(){C&&w(C)},children:k.map(function(x,T){return(0,i.jsx)("div",{onMouseMove:function(){N(x)},onClick:function(L){L.stopPropagation(),w(x)},className:"drum-insert-table-td ".concat(C&&(C==null?void 0:C.x)>=x.x&&(C==null?void 0:C.y)>=x.y?"selected":"")},T)})}),title:(0,i.jsxs)("div",{className:"drum-insert-table-title",children:[(0,i.jsx)("div",{children:"\u63D2\u5165\u8868\u683C"}),C&&(0,i.jsxs)("div",{children:[C.y," x ",C.x]})]}),children:a!=null?a:(0,i.jsx)(ne,{disabled:!!o,icon:(0,i.jsx)(Mr.Z,{})})})})},Ze=function(r){xt()(e,r);var t=yt()(e);function e(n,a){var o;return Ae()(this,e),o=t.call(this,n),V()(ge()(o),"title",void 0),V()(ge()(o),"icon",void 0),V()(ge()(o),"keywords",void 0),V()(ge()(o),"keyboardShortcut",void 0),V()(ge()(o),"onSelect",void 0),o.title=n,o.keywords=a.keywords||[],o.icon=a.icon,o.keyboardShortcut=a.keyboardShortcut,o.onSelect=a.onSelect.bind(ge()(o)),o}return Be()(e)}(Rn.n);function Uo(r,t){var e=[];if(t===null)return e;var n=t.match(/^([1-9]\d?)(?:x([1-9]\d?)?)?$/);if(n!==null){var a=n[1],o=n[2]?[n[2]]:[1,2,3,4,5,6,7,8,9,10].map(String);e.push.apply(e,ze()(o.map(function(l){return new Ze("".concat(a,"x").concat(l," Table"),{icon:(0,i.jsx)("i",{className:"icon table"}),keywords:["table"],onSelect:function(){return r.dispatchCommand(Ut,{columns:l,rows:a})}})})))}return e}function Wo(r){return[new Ze("Paragraph",{icon:(0,i.jsx)("i",{className:"icon paragraph"}),keywords:["normal","paragraph","p","text"],onSelect:function(){return r.update(function(){var e=(0,s.dL)();(0,s.OP)(e)&&(0,ve.Hz)(e,function(){return(0,s.BE)()})})}})].concat(ze()([1,2,3].map(function(t){return new Ze("Heading ".concat(t),{icon:(0,i.jsx)("i",{className:"icon h".concat(t)}),keywords:["heading","header","h".concat(t)],onSelect:function(){return r.update(function(){var n=(0,s.dL)();(0,s.OP)(n)&&(0,ve.Hz)(n,function(){return(0,ce.V1)("h".concat(t))})})}})})),[new Ze("Numbered List",{icon:(0,i.jsx)("i",{className:"icon number"}),keywords:["numbered list","ordered list","ol"],onSelect:function(){return r.dispatchCommand(te.B3,void 0)}}),new Ze("Bulleted List",{icon:(0,i.jsx)("i",{className:"icon bullet"}),keywords:["bulleted list","unordered list","ul"],onSelect:function(){return r.dispatchCommand(te.A3,void 0)}}),new Ze("Check List",{icon:(0,i.jsx)("i",{className:"icon check"}),keywords:["check list","todo list"],onSelect:function(){return r.dispatchCommand(te.d1,void 0)}}),new Ze("Quote",{icon:(0,i.jsx)("i",{className:"icon quote"}),keywords:["block quote"],onSelect:function(){return r.update(function(){var e=(0,s.dL)();(0,s.OP)(e)&&(0,ve.Hz)(e,function(){return(0,ce.Z1)()})})}}),new Ze("Code",{icon:(0,i.jsx)("i",{className:"icon code"}),keywords:["javascript","python","js","codeblock"],onSelect:function(){return r.update(function(){var e=(0,s.dL)();if((0,s.OP)(e))if(e.isCollapsed())(0,ve.Hz)(e,function(){return(0,J.Ol)()});else{var n=e.getTextContent(),a=(0,J.Ol)();e.insertNodes([a]),e.insertRawText(n)}})}}),new Ze("Divider",{icon:(0,i.jsx)("i",{className:"icon horizontal-rule"}),keywords:["horizontal rule","divider","hr"],onSelect:function(){return r.dispatchCommand(Ie.qL,void 0)}})],ze()(["left","center","right","justify"].map(function(t){return new Ze("Align ".concat(t),{icon:(0,i.jsx)("i",{className:"icon ".concat(t,"-align")}),keywords:["align","justify",t],onSelect:function(){return r.dispatchCommand(s.RO,t)}})})))}function Rr(){var r=(0,Te.g)(),t=M()(r,1),e=t[0],n=(0,y.useState)(null),a=M()(n,2),o=a[0],l=a[1],f=(0,Rn.wd)("/",{minLength:0}),v=(0,y.useMemo)(function(){var m=Wo(e);if(!o)return m;var g=new RegExp(o,"i");return[].concat(ze()(Uo(e,o)),ze()(m.filter(function(c){return g.test(c.title)||c.keywords.some(function(u){return g.test(u)})})))},[e,o]),d=(0,y.useCallback)(function(m,g,c,u){e.update(function(){g==null||g.remove(),m.onSelect(u),c()})},[e]);return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(Rn.HQ,{onQueryChange:l,onSelectOption:d,triggerFn:f,options:v,menuRenderFn:function(g,c){var u=c.selectOptionAndCleanUp;return g.current&&v.length?Ue.createPortal((0,i.jsxs)("div",{className:"typeahead-popover component-picker-menu",children:[(0,i.jsx)("div",{className:"component-menu-title",children:"\u57FA\u7840"}),(0,i.jsxs)("div",{className:"component-gird-menu",children:[(0,i.jsx)(ne,{toolTip:"\u6B63\u6587",icon:(0,i.jsx)(ue,{type:"icon-text"}),onClick:function(){u({onSelect:function(){var C=(0,s.dL)();(0,s.OP)(C)&&(0,ve.Hz)(C,function(){return(0,s.BE)()})}})}}),[1,2,3,4,5,6].map(function(h,p){return(0,i.jsx)(ne,{toolTip:"\u6807\u9898".concat(h),icon:(0,i.jsx)(ue,{type:"icon-h-".concat(h)}),onClick:function(){u({onSelect:function(){e.update(function(){var E=(0,s.dL)();(0,s.OP)(E)&&(0,ve.Hz)(E,function(){return(0,ce.V1)("h".concat(h))})})}})}},p)}),(0,i.jsx)(ne,{toolTip:"\u65E0\u5E8F\u5217\u8868",icon:(0,i.jsx)(wr.Z,{}),onClick:function(){u({onSelect:function(){e.dispatchCommand(te.A3,void 0)}})}}),(0,i.jsx)(ne,{toolTip:"\u6709\u5E8F\u5217\u8868",icon:(0,i.jsx)(kr.Z,{}),onClick:function(){u({onSelect:function(){e.dispatchCommand(te.B3,void 0)}})}}),(0,i.jsx)(ne,{toolTip:"\u4EFB\u52A1\u5217\u8868",icon:(0,i.jsx)(Nr.Z,{}),onClick:function(){u({onSelect:function(){e.dispatchCommand(te.d1,void 0)}})}}),(0,i.jsx)(ne,{toolTip:"\u5F15\u7528",icon:(0,i.jsx)(ue,{type:"icon-double-quotes-l"}),onClick:function(){u({onSelect:function(){e.update(function(){var C=(0,s.dL)();(0,ve.Hz)(C,function(){return(0,ce.Z1)()})})}})}}),(0,i.jsx)(ne,{toolTip:"\u4EE3\u7801\u5757",icon:(0,i.jsx)(ue,{type:"icon-code-view"}),onClick:function(){u({onSelect:function(){e.update(function(){var C=(0,s.dL)();if(C!==null)if(C.isCollapsed())(0,ve.Hz)(C,function(){return(0,J.Ol)()});else{var N=C.getTextContent(),E=(0,J.Ol)();C.insertNodes([E]),C=(0,s.dL)(),(0,s.OP)(C)&&C.insertRawText(N)}})}})}})]}),(0,i.jsx)(Kt.Z,{style:{margin:"12px 0"}}),(0,i.jsx)("div",{className:"component-menu-title",children:"\u901A\u7528"}),(0,i.jsx)(Sn,{editor:e,onUpload:function(){u({onSelect:function(){}})},children:(0,i.jsx)("div",{className:"drum-dropdown-item",children:(0,i.jsxs)("div",{children:[(0,i.jsx)(Lr.Z,{})," \u56FE\u7247"]})})}),(0,i.jsx)(Or,{onClick:function(){u({onSelect:function(){}})},editor:e,trigger:"hover",placement:"right",children:(0,i.jsxs)("div",{className:"drum-dropdown-item",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(Mr.Z,{})," \u8868\u683C"]}),(0,i.jsx)(Ko.Z,{})]})})]}),g.current):null}})})}var It=(0,s.fA)("INSERT_IMAGE_COMMAND"),Zo=function(t){return D.TF?(t||window).getSelection():null},Xo="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",jr=document.createElement("img");jr.src=Xo;function Go(r){var t,e=r.target,n=e===null?null:e.nodeType===9?e.defaultView:e.ownerDocument.defaultView,a=Zo(n);if(r.rangeParent&&a!==null)a.collapse(r.rangeParent,r.rangeOffset||0),t=a.getRangeAt(0);else throw Error("Cannot get the selection when dragging");return t}function Yo(r){var t,e=(t=r.dataTransfer)===null||t===void 0?void 0:t.getData("application/x-lexical-drag");if(!e)return null;var n=JSON.parse(e),a=n.type,o=n.data;return a!=="image"?null:o}function Dr(r){var t=r.target;return!!(t&&t instanceof HTMLElement&&!t.closest("code, span.editor-image"))}function jn(){var r=(0,s.dL)();if(!(0,s.iO)(r))return null;var t=r.getNodes(),e=t[0];return ar(e)?e:null}function Vo(r){var t=jn();if(!t)return!1;var e=r.dataTransfer;return e?(e.setData("text/plain","_"),e.setDragImage(jr,0,0),e.setData("application/x-lexical-drag",JSON.stringify({data:{altText:t.__altText,caption:t.__caption,height:t.__height,key:t.getKey(),maxWidth:t.__maxWidth,showCaption:t.__showCaption,src:t.__src,width:t.__width},type:"image"})),!0):!1}function Jo(r){var t=jn();return t?(Dr(r)||r.preventDefault(),!0):!1}function Qo(r,t){var e=jn();if(!e)return!1;var n=Yo(r);if(!n)return!1;if(r.preventDefault(),Dr(r)){var a=Go(r);e.remove();var o=(0,s.vN)();a!=null&&o.applyDOMRange(a),(0,s.oq)(o),t.dispatchCommand(It,n)}return!0}var Pr=function(){var t=(0,Te.g)(),e=M()(t,1),n=e[0];return(0,y.useEffect)(function(){if(!n.hasNodes([qt]))throw new Error("ImagesPlugin: ImageNode not registered on editor");return(0,D.qV)(n.registerCommand(It,function(a){var o=en(a);return(0,s.od)([o]),(0,s._v)(o.getParentOrThrow())&&(0,D.JB)(o,s.BE).selectEnd(),!0},s.VN),n.registerCommand(s.XI,function(a){return Vo(a)},s.Eo),n.registerCommand(s.kE,function(a){return Jo(a)},s.KB),n.registerCommand(s.zD,function(a){return Qo(a,n)},s.Eo))},[n]),null},Ir=["image/","image/heic","image/heif","image/gif","image/webp"];function Ar(){var r=(0,Te.g)(),t=M()(r,1),e=t[0];return(0,y.useEffect)(function(){return e.registerCommand(ce.BD,function(n){return Dt()(We()().mark(function a(){var o,l,f,v,d,m;return We()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,D.j5)(n,[Ir].flatMap(function(u){return u}));case 2:o=c.sent,l=Xe()(o);try{for(l.s();!(f=l.n()).done;)v=f.value,d=v.file,m=v.result,(0,D.tV)(d,Ir)&&e.dispatchCommand(It,{altText:d.name,src:m})}catch(u){l.e(u)}finally{l.f()}case 5:case"end":return c.stop()}},a)}))(),!0},s.KB)},[e]),null}var qo="draggable-block-menu";function ei(r){return!!r.closest(".".concat(qo))}var Br=function(t){var e=t.anchorElem,n=e===void 0?document.body:e,a=(0,y.useRef)(null),o=(0,y.useRef)(null);return(0,i.jsx)(zr,{anchorElem:n,menuRef:a,targetLineRef:o,menuComponent:(0,i.jsx)("div",{ref:a,className:"icon draggable-block-menu",children:(0,i.jsx)("div",{className:"icon"})}),targetLineComponent:(0,i.jsx)("div",{ref:o,className:"draggable-block-target-line"}),isOnMenu:ei})},Fr=function(){function r(t,e){Ae()(this,r),V()(this,"_x",void 0),V()(this,"_y",void 0),this._x=t,this._y=e}return Be()(r,[{key:"x",get:function(){return this._x}},{key:"y",get:function(){return this._y}},{key:"equals",value:function(e){var n=e.x,a=e.y;return this.x===n&&this.y===a}},{key:"calcDeltaXTo",value:function(e){var n=e.x;return this.x-n}},{key:"calcDeltaYTo",value:function(e){var n=e.y;return this.y-n}},{key:"calcHorizontalDistanceTo",value:function(e){return Math.abs(this.calcDeltaXTo(e))}},{key:"calcVerticalDistance",value:function(e){return Math.abs(this.calcDeltaYTo(e))}},{key:"calcDistanceTo",value:function(e){return Math.sqrt(Math.pow(this.calcDeltaXTo(e),2)+Math.pow(this.calcDeltaYTo(e),2))}}]),r}();function ti(r){return r instanceof Fr}var ni=function(){function r(t,e,n,a){Ae()(this,r),V()(this,"_left",void 0),V()(this,"_top",void 0),V()(this,"_right",void 0),V()(this,"_bottom",void 0);var o=e<=a?[e,a]:[a,e],l=M()(o,2),f=l[0],v=l[1],d=t<=n?[t,n]:[n,t],m=M()(d,2),g=m[0],c=m[1];this._top=f,this._right=c,this._left=g,this._bottom=v}return Be()(r,[{key:"top",get:function(){return this._top}},{key:"right",get:function(){return this._right}},{key:"bottom",get:function(){return this._bottom}},{key:"left",get:function(){return this._left}},{key:"width",get:function(){return Math.abs(this._left-this._right)}},{key:"height",get:function(){return Math.abs(this._bottom-this._top)}},{key:"equals",value:function(e){var n=e.top,a=e.left,o=e.bottom,l=e.right;return n===this._top&&o===this._bottom&&a===this._left&&l===this._right}},{key:"contains",value:function(e){if(ti(e)){var n=e.x,a=e.y,o=a<this._top,l=a>this._bottom,f=n<this._left,v=n>this._right,d=!o&&!l&&!f&&!v;return{reason:{isOnBottomSide:l,isOnLeftSide:f,isOnRightSide:v,isOnTopSide:o},result:d}}else{var m=e.top,g=e.left,c=e.bottom,u=e.right;return m>=this._top&&m<=this._bottom&&c>=this._top&&c<=this._bottom&&g>=this._left&&g<=this._right&&u>=this._left&&u<=this._right}}},{key:"intersectsWith",value:function(e){var n=e.left,a=e.top,o=e.width,l=e.height,f=this.left,v=this.top,d=this.width,m=this.height,g=n+o>=f+d?n+o:f+d,c=a+l>=v+m?a+l:v+m,u=n<=f?n:f,h=a<=v?a:v;return g-u<=o+d&&c-h<=l+m}},{key:"generateNewRect",value:function(e){var n=e.left,a=n===void 0?this.left:n,o=e.top,l=o===void 0?this.top:o,f=e.right,v=f===void 0?this.right:f,d=e.bottom,m=d===void 0?this.bottom:d;return new r(a,l,v,m)}}],[{key:"fromLTRB",value:function(e,n,a,o){return new r(e,n,a,o)}},{key:"fromLWTH",value:function(e,n,a,o){return new r(e,a,e+n,a+o)}},{key:"fromPoints",value:function(e,n){var a=e.y,o=e.x,l=n.y,f=n.x;return r.fromLTRB(o,a,f,l)}},{key:"fromDOM",value:function(e){var n=e.getBoundingClientRect(),a=n.top,o=n.width,l=n.left,f=n.height;return r.fromLWTH(l,o,a,f)}}]),r}(),Dn=4,ri=2,_r="application/x-lexical-drag-block",$r=28,ai=1,oi=-1,Hr=0,rn=1/0;function ii(r){return r===0?1/0:rn>=0&&rn<r?rn:Math.floor(r/2)}function li(r){return r.getEditorState().read(function(){return(0,s.Gv)().getChildrenKeys()})}function Kr(r){var t=function(m,g){return m?parseFloat(window.getComputedStyle(m)[g]):0},e=window.getComputedStyle(r),n=e.marginTop,a=e.marginBottom,o=t(r.previousElementSibling,"marginBottom"),l=t(r.nextElementSibling,"marginTop"),f=Math.max(parseFloat(n),o),v=Math.max(parseFloat(a),l);return{marginBottom:v,marginTop:f}}function Pn(r,t,e){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=r.getBoundingClientRect(),o=li(t),l=null;return t.getEditorState().read(function(){if(n){var f=[t.getElementByKey(o[0]),t.getElementByKey(o[o.length-1])],v=f[0],d=f[1],m=v!==null?v.getBoundingClientRect():void 0,g=d!==null?d.getBoundingClientRect():void 0;if(m&&g){var c=(0,D.MZ)(v),u=(0,D.MZ)(d);if(e.y/c<m.top?l=v:e.y/u>g.bottom&&(l=d),l)return}}for(var h=ii(o.length),p=Hr;h>=0&&h<o.length;){var C=o[h],N=t.getElementByKey(C);if(N===null)break;var E=(0,D.MZ)(N),b=new Fr(e.x/E,e.y/E),k=ni.fromDOM(N),w=Kr(N),x=w.marginTop,T=w.marginBottom,O=k.generateNewRect({bottom:k.bottom+T,left:a.left,right:a.right,top:k.top-x}),L=O.contains(b),R=L.result,A=L.reason,K=A.isOnTopSide,B=A.isOnBottomSide;if(R){l=N,rn=h;break}p===Hr&&(K?p=oi:B?p=ai:p=1/0),h+=p}}),l}function si(r,t,e){if(!r){t.style.opacity="0",t.style.transform="translate(-10000px, -10000px)";return}var n=r.getBoundingClientRect(),a=window.getComputedStyle(r),o=t.getBoundingClientRect(),l=e.getBoundingClientRect(),f=n.top+(parseInt(a.lineHeight,10)-o.height)/2-l.top,v=Dn;t.style.opacity="1",t.style.transform="translate(".concat(v,"px, ").concat(f,"px)")}function ui(r,t){var e=t.style.transform;t.style.transform="translateZ(0)",r.setDragImage(t,0,0),setTimeout(function(){t.style.transform=e})}function ci(r,t,e,n){var a=t.getBoundingClientRect(),o=a.top,l=a.height,f=n.getBoundingClientRect(),v=f.top,d=f.width,m=Kr(t),g=m.marginTop,c=m.marginBottom,u=o;e>=o?u+=l+c/2:u-=g/2;var h=u-v-ri,p=$r-Dn;r.style.transform="translate(".concat(p,"px, ").concat(h,"px)"),r.style.width="".concat(d-($r-Dn)*2,"px"),r.style.opacity=".4"}function di(r){r&&(r.style.opacity="0",r.style.transform="translate(-10000px, -10000px)")}function fi(r,t,e,n,a,o,l,f){var v=t.parentElement,d=(0,y.useRef)(!1),m=(0,y.useState)(null),g=M()(m,2),c=g[0],u=g[1];(0,y.useEffect)(function(){function C(E){var b=E.target;if(b!==null&&!(0,s.Re)(b)){u(null);return}if(!(b!==null&&f(b))){var k=Pn(t,r,E);u(k)}}function N(){u(null)}return v!==null&&(v.addEventListener("mousemove",C),v.addEventListener("mouseleave",N)),function(){v!==null&&(v.removeEventListener("mousemove",C),v.removeEventListener("mouseleave",N))}},[v,t,r,f]),(0,y.useEffect)(function(){e.current&&si(c,e.current,t)},[t,c,e]),(0,y.useEffect)(function(){function C(E){if(!d.current)return!1;var b=(0,ce.UW)(E),k=M()(b,1),w=k[0];if(w)return!1;var x=E.pageY,T=E.target;if(T!==null&&!(0,s.Re)(T))return!1;var O=Pn(t,r,E,!0),L=n.current;return O===null||L===null?!1:(ci(L,O,x/(0,D.MZ)(T),t),E.preventDefault(),!0)}function N(E){if(!d.current)return!1;var b=(0,ce.UW)(E),k=M()(b,1),w=k[0];if(w)return!1;var x=E.target,T=E.dataTransfer,O=E.pageY,L=T!==null?T.getData(_r):"",R=(0,s.gI)(L);if(!R||x!==null&&!(0,s.Re)(x))return!1;var A=Pn(t,r,E,!0);if(!A)return!1;var K=(0,s.Xo)(A);if(!K)return!1;if(K===R)return!0;var B=A.getBoundingClientRect().top;return O/(0,D.MZ)(x)>=B?K.insertAfter(R):K.insertBefore(R),u(null),!0}return(0,D.qV)(r.registerCommand(s.kE,function(E){return C(E)},s.KB),r.registerCommand(s.zD,function(E){return N(E)},s.Eo))},[t,r,n]);function h(C){var N=C.dataTransfer;if(!(!N||!c)){ui(N,c);var E="";r.update(function(){var b=(0,s.Xo)(c);b&&(E=b.getKey())}),d.current=!0,N.setData(_r,E)}}function p(){d.current=!1,di(n.current)}return(0,Ue.createPortal)((0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{draggable:!0,onDragStart:h,onDragEnd:p,children:a&&o}),l]}),t)}function zr(r){var t=r.anchorElem,e=t===void 0?document.body:t,n=r.menuRef,a=r.targetLineRef,o=r.menuComponent,l=r.targetLineComponent,f=r.isOnMenu,v=(0,Te.g)(),d=M()(v,1),m=d[0];return fi(m,e,n,a,m._editable,o,l,f)}function Ur(r){var t=r.hasCellMerge,e=t===void 0?!0:t,n=r.hasCellBackgroundColor,a=n===void 0?!0:n,o=r.hasTabHandler,l=o===void 0?!0:o,f=(0,Te.g)(),v=M()(f,1),d=v[0];return(0,y.useEffect)(function(){return d.hasNodes([Tt,ot,Wt])||q(!1,"TablePlugin: TableNode, TableCellNode or TableRowNode not registered on editor"),(0,D.qV)(d.registerCommand(Ut,function(m){var g=m.columns,c=m.rows,u=m.includeHeaders,h=Un(Number(c),Number(g),u);(0,D.z8)(h);var p=h.getFirstDescendant();return(0,s.Gg)(p)&&p.select(),!0},s.VN),d.registerNodeTransform(Tt,function(m){for(var g=Zt(m,null,null),c=M()(g,1),u=c[0],h=u.reduce(function(w,x){return Math.max(w,x.length)},0),p=0;p<u.length;++p){var C=u[p].length;if(C!==h)for(var N=u[p][C-1],E=N.cell,b=C;b<h;++b){var k=Ee(0);k.append((0,s.BE)()),E!==null?E.insertAfter(k):(0,D.bV)(E,k)}}}))},[d]),(0,y.useEffect)(function(){var m=new Map,g=function(h){var p=h.getKey(),C=d.getElementByKey(p);if(C&&!m.has(p)){var N=Jn(h,C,d,l);m.set(p,N)}},c=d.registerMutationListener(Tt,function(u){var h=Xe()(u),p;try{var C=function(){var E=M()(p.value,2),b=E[0],k=E[1];if(k==="created")d.getEditorState().read(function(){var x=(0,s.gI)(b);fe(x)&&g(x)});else if(k==="destroyed"){var w=m.get(b);w!==void 0&&(w.removeListeners(),m.delete(b))}};for(h.s();!(p=h.n()).done;)C()}catch(N){h.e(N)}finally{h.f()}},{skipInitialization:!1});return function(){c();var u=Xe()(m),h;try{for(u.s();!(h=u.n()).done;){var p=M()(h.value,2),C=p[1];C.removeListeners()}}catch(N){u.e(N)}finally{u.f()}}},[d,l]),(0,y.useEffect)(function(){if(!e)return d.registerNodeTransform(ot,function(m){if(m.getColSpan()>1||m.getRowSpan()>1){var g=be(m),c=M()(g,3),u=c[2],h=Re(u,m,m),p=M()(h,1),C=p[0],N=C.length,E=C[0].length,b=u.getFirstChild();q(de(b),"Expected TableNode first child to be a RowNode");for(var k=[],w=0;w<N;w++){w!==0&&(b=b.getNextSibling(),q(de(b),"Expected TableNode first child to be a RowNode"));for(var x=null,T=0;T<E;T++){var O=C[w][T],L=O.cell;if(O.startRow===w&&O.startColumn===T)x=L,k.push(L);else if(L.getColSpan()>1||L.getRowSpan()>1){q(W(L),"Expected TableNode cell to be a TableCellNode");var R=Ee(L.__headerState);x!==null?x.insertAfter(R):(0,D.bV)(b,R)}}}for(var A=0,K=k;A<K.length;A++){var B=K[A];B.setColSpan(1),B.setRowSpan(1)}}})},[d,e]),(0,y.useEffect)(function(){if(!a)return d.registerNodeTransform(ot,function(m){m.getBackgroundColor()!==null&&m.setBackgroundColor(null)})},[d,a,e]),null}var vi=S(34239),mi=new Set(["http:","https:","mailto:","sms:","tel:"]);function In(r){try{var t=new URL(r);if(!mi.has(t.protocol))return"about:blank"}catch(e){return r}return r}var hi=new RegExp(/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[-;:&=+$,\w]+@)?[A-Za-z0-9.-]+|(?:www.|[-;:&=+$,\w]+@)[A-Za-z0-9.-]+)((?:\/[+~%/.\w-_]*)?\??(?:[-+=&;%@.\w_]*)#?(?:[\w]*))?)/);function gi(r){return r==="https://"||hi.test(r)}function pi(){return(0,i.jsx)(vi.H,{validateUrl:gi})}var Wr="\u8F93\u5165\u201C/\u201D\u5FEB\u901F\u63D2\u5165",Ci=function(){var t=(0,y.useState)(null),e=M()(t,2),n=e[0],a=e[1],o=(0,y.useState)(!1),l=M()(o,2),f=l[0],v=l[1],d=(0,y.useState)(!1),m=M()(d,2),g=m[0],c=m[1],u=function(p){p!==null&&a(p)};return(0,y.useEffect)(function(){var h=function(){var C=D.TF&&window.matchMedia("(max-width: 1025px)").matches;C!==f&&v(C)};return h(),window.addEventListener("resize",h),function(){window.removeEventListener("resize",h)}},[f]),(0,i.jsxs)("div",{className:"editor-shell",children:[(0,i.jsx)(sa,{setIsLinkEditMode:c}),(0,i.jsxs)("div",{className:"editor-container",children:[(0,i.jsx)(Ot.B,{contentEditable:(0,i.jsx)("div",{className:"editor-scroller",children:(0,i.jsx)("div",{className:"editor",ref:u,children:(0,i.jsx)(se.f,{className:"content-editable-root","aria-placeholder":Wr,placeholder:(0,i.jsx)("div",{className:"content-editable-placeholder",children:Wr})})})}),ErrorBoundary:Ye.g,placeholder:null}),(0,i.jsx)(Ke.e,{}),(0,i.jsx)(He.C,{}),(0,i.jsx)(Pr,{}),(0,i.jsx)(Ur,{hasCellMerge:!0,hasCellBackgroundColor:!0,hasTabHandler:!0}),(0,i.jsx)(Oe.B,{}),(0,i.jsx)(gn.E,{}),(0,i.jsx)(mt.f,{}),(0,i.jsx)(pi,{}),(0,i.jsx)(sr,{}),(0,i.jsx)(ht.r,{}),(0,i.jsx)(aa,{}),(0,i.jsx)(gt.u,{}),(0,i.jsx)(Rr,{}),(0,i.jsx)(Ar,{}),(0,i.jsx)(Er,{}),(0,i.jsx)(Lt.y,{}),(0,i.jsx)(oa,{}),!!n&&!f&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(Br,{anchorElem:n}),(0,i.jsx)(lr,{anchorElem:n}),(0,i.jsx)(Xr,{anchorElem:n,isLinkEditMode:g,setIsLinkEditMode:c}),(0,i.jsx)(ta,{anchorElem:n,setIsLinkEditMode:c})]})]})]})},xi=10,yi=5;function Zr(r,t,e){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:xi,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:yi,o=e.parentElement;if(r===null||!o){t.style.opacity="0",t.style.transform="translate(-10000px, -10000px)";return}var l=t.getBoundingClientRect(),f=e.getBoundingClientRect(),v=o.getBoundingClientRect(),d=r.top-n,m=r.left-a;d<v.top&&(d+=l.height+r.height+n*2),m+l.width>v.right&&(m=v.right-l.width-a),d-=f.top,m-=f.left,t.style.opacity="1",t.style.transform="translate(".concat(m,"px, ").concat(d,"px)")}function Et(r){var t=r.anchor,e=r.focus,n=r.anchor.getNode(),a=r.focus.getNode();if(n===a)return n;var o=r.isBackward();return o?(0,ve.P4)(e)?n:a:(0,ve.P4)(t)?n:a}function Si(r){var t=r.editor,e=r.isLink,n=r.setIsLink,a=r.anchorElem,o=r.isLinkEditMode,l=r.setIsLinkEditMode,f=(0,y.useRef)(null),v=(0,y.useRef)(null),d=(0,y.useState)(""),m=M()(d,2),g=m[0],c=m[1],u=(0,y.useState)("https://"),h=M()(u,2),p=h[0],C=h[1],N=(0,y.useState)(null),E=M()(N,2),b=E[0],k=E[1],w=(0,y.useCallback)(function(){var O=(0,s.dL)();if((0,s.OP)(O)){var L=Et(O),R=(0,D.$s)(L,Q.Pq);R?c(R.getURL()):(0,Q.Pq)(L)?c(L.getURL()):c(""),o&&C(g)}var A=f.current,K=window.getSelection(),B=document.activeElement;if(A!==null){var P=t.getRootElement();if(O!==null&&K!==null&&P!==null&&P.contains(K.anchorNode)&&t.isEditable()){var I,U=(I=K.focusNode)===null||I===void 0||(I=I.parentElement)===null||I===void 0?void 0:I.getBoundingClientRect();U&&(U.y+=40,Zr(U,A,a)),k(O)}else(!B||B.className!=="link-input")&&(P!==null&&Zr(null,A,a),k(null),l(!1),c(""));return!0}},[a,t,l,o,g]);(0,y.useEffect)(function(){var O=a.parentElement,L=function(){t.getEditorState().read(function(){w()})};return window.addEventListener("resize",L),O&&O.addEventListener("scroll",L),function(){window.removeEventListener("resize",L),O&&O.removeEventListener("scroll",L)}},[a.parentElement,t,w]),(0,y.useEffect)(function(){return(0,D.qV)(t.registerUpdateListener(function(O){var L=O.editorState;L.read(function(){w()})}),t.registerCommand(s.oj,function(){return w(),!0},s.KB),t.registerCommand(s.Zq,function(){return e?(n(!1),!0):!1},s.Eo))},[t,w,n,e]),(0,y.useEffect)(function(){t.getEditorState().read(function(){w()})},[t,w]),(0,y.useEffect)(function(){o&&v.current&&v.current.focus()},[o,e]);var x=function(){b!==null&&(g!==""&&(t.dispatchCommand(Q.k0,In(p)),t.update(function(){var L=(0,s.dL)();if((0,s.OP)(L)){var R=Et(L).getParent();if((0,Q.Xp)(R)){var A=(0,Q.zV)(R.getURL(),{rel:R.__rel,target:R.__target,title:R.__title});R.replace(A,!0)}}})),C("https://"),l(!1))},T=function(L){L.key==="Enter"?(L.preventDefault(),x()):L.key==="Escape"&&(L.preventDefault(),l(!1))};return(0,i.jsx)("div",{ref:f,className:"link-editor",children:e?o?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("input",{ref:v,className:"link-input",value:p,onChange:function(L){C(L.target.value)},onKeyDown:function(L){T(L)}}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"link-cancel",role:"button",tabIndex:0,onMouseDown:function(L){return L.preventDefault()},onClick:function(){l(!1)}}),(0,i.jsx)("div",{className:"link-confirm",role:"button",tabIndex:0,onMouseDown:function(L){return L.preventDefault()},onClick:x})]})]}):(0,i.jsxs)("div",{className:"link-view",children:[(0,i.jsx)("a",{href:In(g),target:"_blank",rel:"noopener noreferrer",children:g}),(0,i.jsx)("div",{className:"link-edit",role:"button",tabIndex:0,onMouseDown:function(L){return L.preventDefault()},onClick:function(){C(g),l(!0)}}),(0,i.jsx)("div",{className:"link-trash",role:"button",tabIndex:0,onMouseDown:function(L){return L.preventDefault()},onClick:function(){t.dispatchCommand(Q.k0,null)}})]}):null})}function bi(r,t,e,n){var a=(0,y.useState)(r),o=M()(a,2),l=o[0],f=o[1],v=(0,y.useState)(!1),d=M()(v,2),m=d[0],g=d[1];return(0,y.useEffect)(function(){function c(){var u=(0,s.dL)();if((0,s.OP)(u)){var h=Et(u),p=(0,D.$s)(h,Q.Pq),C=(0,D.$s)(h,Q.Xp);if(!(p||C)){g(!1);return}var N=u.getNodes().filter(function(E){return!(0,s.A3)(E)}).find(function(E){var b=(0,D.$s)(E,Q.Pq),k=(0,D.$s)(E,Q.Xp);return p&&!p.is(b)||b&&!b.is(p)||C&&!C.is(k)||k&&(!k.is(C)||k.getIsUnlinked())});g(!N)}}return(0,D.qV)(r.registerUpdateListener(function(u){var h=u.editorState;h.read(function(){c()})}),r.registerCommand(s.oj,function(u,h){return c(),f(h),!1},s.jw),r.registerCommand(s.Kr,function(u){var h=(0,s.dL)();if((0,s.OP)(h)){var p=Et(h),C=(0,D.$s)(p,Q.Pq);if((0,Q.Pq)(C)&&(u.metaKey||u.ctrlKey))return window.open(C.getURL(),"_blank"),!0}return!1},s.KB))},[r]),(0,Ue.createPortal)((0,i.jsx)(Si,{editor:l,isLink:m,anchorElem:t,setIsLink:g,isLinkEditMode:e,setIsLinkEditMode:n}),t)}function Xr(r){var t=r.anchorElem,e=t===void 0?document.body:t,n=r.isLinkEditMode,a=r.setIsLinkEditMode,o=(0,Te.g)(),l=M()(o,1),f=l[0];return bi(f,e,n,a)}var Gr=S(65887),Yr=S(69938),Vr=S(81734),Jr=S(10531),Qr=S(39961);function Ti(r,t){var e=r.getRangeAt(0),n;if(r.anchorNode===t){for(var a=t;a.firstElementChild!==null;)a=a.firstElementChild;n=a.getBoundingClientRect()}else n=e.getBoundingClientRect();return n}var Ei=10,wi=5;function ki(r,t,e){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:Ei,o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:wi,l=e.parentElement;if(r===null||!l){t.style.opacity="0",t.style.transform="translate(-10000px, -10000px)";return}var f=t.getBoundingClientRect(),v=e.getBoundingClientRect(),d=l.getBoundingClientRect(),m=r.top-f.height-a,g=r.left-o;m<d.top&&(m+=f.height+r.height+a*(n?9:2)),g+f.width>d.right&&(g=d.right-f.width-o),m-=v.top,g-=v.left,t.style.opacity="1",t.style.transform="translate(".concat(g,"px, ").concat(m,"px)")}var Ge={paragraph:{name:"\u6B63\u6587",icon:(0,i.jsx)(ue,{type:"icon-text"})},h1:{name:"\u6807\u9898 1",icon:(0,i.jsx)(ue,{type:"icon-h-1"})},h2:{name:"\u6807\u9898 2",icon:(0,i.jsx)(ue,{type:"icon-h-2"})},h3:{name:"\u6807\u9898 3",icon:(0,i.jsx)(ue,{type:"icon-h-3"})},h4:{name:"\u6807\u9898 4",icon:(0,i.jsx)(ue,{type:"icon-h-4"})},h5:{name:"\u6807\u9898 5",icon:(0,i.jsx)(ue,{type:"icon-h-5"})},h6:{name:"\u6807\u9898 6",icon:(0,i.jsx)(ue,{type:"icon-h-6"})},bullet:{name:"\u65E0\u5E8F\u5217\u8868",icon:(0,i.jsx)(wr.Z,{})},number:{name:"\u6709\u5E8F\u5217\u8868",icon:(0,i.jsx)(kr.Z,{})},check:{name:"\u4EFB\u52A1\u5217\u8868",icon:(0,i.jsx)(Nr.Z,{})},quote:{name:"\u5F15\u7528",icon:(0,i.jsx)(ue,{type:"icon-double-quotes-l"})},code:{name:"\u4EE3\u7801\u5757",icon:(0,i.jsx)(ue,{type:"icon-code-view"})}},an={left:{name:"\u5DE6\u5BF9\u9F50",icon:(0,i.jsx)(ue,{type:"icon-align-left"})},center:{name:"\u5C45\u4E2D\u5BF9\u9F50",icon:(0,i.jsx)(ue,{type:"icon-align-center"})},right:{name:"\u53F3\u5BF9\u9F50",icon:(0,i.jsx)(ue,{type:"icon-align-right"})}},qr={"12px":{name:"12px"},"13px":{name:"13px"},"14px":{name:"14px"},"15px":{name:"15px"},"16px":{name:"16px"},"19px":{name:"19px"},"22px":{name:"22px"},"24px":{name:"24px"},"29px":{name:"29px"},"32px":{name:"32px"},"40px":{name:"40px"},"48px":{name:"48px"}},ea=function(t){var e,n=t.editor,a=t.disabled,o=t.buttonLabel,l=t.blockType,f=t.hideLabel,v=t.blockFormatRef,d=(0,y.useState)(!1),m=M()(d,2),g=m[0],c=m[1],u=function(T){c(T)},h=function(){n.update(function(){var T=(0,s.dL)();(0,s.OP)(T)&&(0,ve.Hz)(T,function(){return(0,s.BE)()})})},p=function(T){l!==T&&n.update(function(){var O=(0,s.dL)();(0,ve.Hz)(O,function(){return(0,ce.V1)(T)})})},C=function(){l!=="check"?n.dispatchCommand(te.d1,void 0):h()},N=function(){l!=="number"?n.dispatchCommand(te.B3,void 0):h()},E=function(){l!=="bullet"?n.dispatchCommand(te.A3,void 0):h()},b=function(){l!=="quote"&&n.update(function(){var T=(0,s.dL)();(0,ve.Hz)(T,function(){return(0,ce.Z1)()})})},k=function(){l!=="code"&&n.update(function(){var T=(0,s.dL)();if(T!==null)if(T.isCollapsed())(0,ve.Hz)(T,function(){return(0,J.Ol)()});else{var O=T.getTextContent(),L=(0,J.Ol)();T.insertNodes([L]),T=(0,s.dL)(),(0,s.OP)(T)&&T.insertRawText(O)}})},w=function(T){switch(c(!1),T){case"paragraph":h();break;case"h1":p("h1");break;case"h2":p("h2");break;case"h3":p("h3");break;case"h4":p("h4");break;case"h5":p("h5");break;case"h6":p("h6");break;case"bullet":E();break;case"number":N();break;case"check":C();break;case"quote":b();break;case"code":k();break}};return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(Je.Z,{placement:"bottomLeft",overlayInnerStyle:{padding:"0px"},arrow:!1,open:g,onOpenChange:u,content:(0,i.jsx)("div",{className:"drum-dropdown-content",ref:v,children:Object.keys(Ge).map(function(x,T){return(0,i.jsxs)("div",{className:"drum-dropdown-item ".concat(l===x?"active":""),onClick:function(){w(x)},children:[(0,i.jsxs)("div",{children:[Ge[x].icon," ",(0,i.jsx)("span",{children:Ge[x].name})]}),l===x&&(0,i.jsx)(Ve.Z,{})]},T)})}),trigger:"click",children:(0,i.jsxs)(ye.ZP,{disabled:!!a,type:"text",onClick:function(){c(!g)},children:[(0,i.jsxs)("div",{style:{width:f?"10px":"75px",textAlign:"left"},children:[l?(e=Ge[l])===null||e===void 0?void 0:e.icon:""," ",f?"":o]}),(0,i.jsx)(nt.Z,{})]})})})};function Ni(r){var t,e=r.editor,n=r.anchorElem,a=r.isLink,o=r.blockType,l=r.isBold,f=r.isItalic,v=r.isUnderline,d=r.isCode,m=r.isStrikethrough,g=r.setIsLinkEditMode,c=r.blockFormatRef,u=(0,y.useRef)(null),h=(0,y.useCallback)(function(){a?(g(!1),e.dispatchCommand(Q.k0,null)):(g(!0),e.dispatchCommand(Q.k0,"https://"))},[e,a,g]),p=function(){e.dispatchCommand(nn,void 0)};function C(b){if(u!=null&&u.current&&(b.buttons===1||b.buttons===3)&&u.current.style.pointerEvents!=="none"){var k=b.clientX,w=b.clientY,x=document.elementFromPoint(k,w);u.current.contains(x)||(u.current.style.pointerEvents="none")}}function N(){u!=null&&u.current&&u.current.style.pointerEvents!=="auto"&&(u.current.style.pointerEvents="auto")}(0,y.useEffect)(function(){if(u!=null&&u.current)return document.addEventListener("mousemove",C),document.addEventListener("mouseup",N),function(){document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",N)}},[u]);var E=(0,y.useCallback)(function(){var b=(0,s.dL)(),k=u.current,w=window.getSelection();if(k!==null){var x=e.getRootElement();if(b!==null&&w!==null&&!w.isCollapsed&&x!==null&&x.contains(w.anchorNode)){var T=Ti(w,x);ki(T,k,n,a)}}},[e,n,a]);return(0,y.useEffect)(function(){var b=n.parentElement,k=function(){e.getEditorState().read(function(){E()})};return window.addEventListener("resize",k),b&&b.addEventListener("scroll",k),function(){window.removeEventListener("resize",k),b&&b.removeEventListener("scroll",k)}},[e,E,n]),(0,y.useEffect)(function(){return e.getEditorState().read(function(){E()}),(0,D.qV)(e.registerUpdateListener(function(b){var k=b.editorState;k.read(function(){E()})}),e.registerCommand(s.oj,function(){return E(),!1},s.KB))},[e,E]),(0,i.jsxs)("div",{ref:u,className:"floating-text-format-popup",children:[e.isEditable()&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(ea,{editor:e,buttonLabel:(t=Ge[o])===null||t===void 0?void 0:t.name,blockType:o,hideLabel:!0,blockFormatRef:c}),(0,i.jsx)(at,{}),(0,i.jsx)(ne,{icon:(0,i.jsx)(Gr.Z,{}),toolTip:"\u52A0\u7C97".concat(D.jB?" (\u2318 B)":" (Ctrl+B)"),active:l,onClick:function(){e.dispatchCommand(s.Ew,"bold")}}),(0,i.jsx)(ne,{icon:(0,i.jsx)(Yr.Z,{}),toolTip:"\u659C\u4F53".concat(D.jB?" (\u2318 I)":" (Ctrl+I)"),active:f,onClick:function(){e.dispatchCommand(s.Ew,"italic")}}),(0,i.jsx)(ne,{icon:(0,i.jsx)(Vr.Z,{}),toolTip:"\u4E0B\u5212\u7EBF".concat(D.jB?" (\u2318 U)":" (Ctrl+U)"),active:v,onClick:function(){e.dispatchCommand(s.Ew,"underline")}}),(0,i.jsx)(ne,{icon:(0,i.jsx)(Jr.Z,{}),toolTip:"\u5220\u9664\u7EBF",active:m,onClick:function(){e.dispatchCommand(s.Ew,"strikethrough")}}),(0,i.jsx)(ne,{icon:(0,i.jsx)(ue,{type:"icon-code-view"}),toolTip:"\u884C\u5185\u4EE3\u7801",active:d,onClick:function(){e.dispatchCommand(s.Ew,"code")}}),(0,i.jsx)(ne,{icon:(0,i.jsx)(Qr.Z,{}),toolTip:"\u94FE\u63A5",active:a,onClick:function(){h()}}),(0,i.jsx)(at,{})]}),(0,i.jsx)(ne,{icon:(0,i.jsx)(fr.Z,{}),toolTip:"\u8BC4\u8BBA",onClick:function(){p()}})]})}function Li(r,t,e){var n=(0,y.useRef)(null),a=(0,y.useState)("paragraph"),o=M()(a,2),l=o[0],f=o[1],v=(0,y.useState)(!1),d=M()(v,2),m=d[0],g=d[1],c=(0,y.useState)(!1),u=M()(c,2),h=u[0],p=u[1],C=(0,y.useState)(!1),N=M()(C,2),E=N[0],b=N[1],k=(0,y.useState)(!1),w=M()(k,2),x=w[0],T=w[1],O=(0,y.useState)(!1),L=M()(O,2),R=L[0],A=L[1],K=(0,y.useState)(!1),B=M()(K,2),P=B[0],I=B[1],U=(0,y.useState)(!1),X=M()(U,2),H=X[0],$=X[1],z=(0,y.useCallback)(function(){r.getEditorState().read(function(){if(!r.isComposing()){var j=(0,s.dL)(),F=window.getSelection(),_=r.getRootElement();if(F!==null&&(!(0,s.OP)(j)||_===null||!_.contains(F.anchorNode))&&!n.current){g(!1);return}if((0,s.OP)(j)){var G=Et(j);b(j.hasFormat("bold")),T(j.hasFormat("italic")),A(j.hasFormat("underline")),I(j.hasFormat("strikethrough")),$(j.hasFormat("code"));var Z=G.getParent();(0,Q.Pq)(Z)||(0,Q.Pq)(G)?p(!0):p(!1);var ee=j.anchor.getNode(),re=ee.getKey()==="root"?ee:(0,D.$s)(ee,function(xe){var Me=xe.getParent();return Me!==null&&(0,s._v)(Me)});re===null&&(re=ee.getTopLevelElementOrThrow());var me=re.getKey(),Ne=r.getElementByKey(me);if(Ne!==null)if((0,te.I3)(re)){var je=(0,D.yD)(ee,te.EG),De=je?je.getListType():re.getListType();f(De)}else{var we=(0,ce.rc)(re)?re.getTag():re.getType();we in Ge&&f(we)}!(0,J.jZ)(j.anchor.getNode())&&j.getTextContent()!==""?g((0,s.Gg)(G)||(0,s.Rl)(G)):g(!1);var Le=j.getTextContent().replace(/\n/g,"");if(!j.isCollapsed()&&Le===""){g(!1);return}}}})},[r]);return(0,y.useEffect)(function(){return document.addEventListener("selectionchange",z),function(){document.removeEventListener("selectionchange",z)}},[z]),(0,y.useEffect)(function(){return(0,D.qV)(r.registerUpdateListener(function(){z()}),r.registerRootListener(function(){r.getRootElement()===null&&g(!1)}))},[r,z]),m?(0,Ue.createPortal)((0,i.jsx)(Ni,{editor:r,anchorElem:t,blockType:l,isLink:h,isBold:E,isItalic:x,isStrikethrough:P,isUnderline:R,isCode:H,setIsLinkEditMode:e,blockFormatRef:n}),t):null}function ta(r){var t=r.anchorElem,e=t===void 0?document.body:t,n=r.setIsLinkEditMode,a=(0,Te.g)(),o=M()(a,1),l=o[0];return Li(l,e,n)}var Mi=1,Oi=100,na=0,ra=!1;function Ri(){window.addEventListener("keydown",function(r){r.key==="Tab"&&(na=r.timeStamp)},!0)}function aa(){var r=(0,Te.g)(),t=M()(r,1),e=t[0];return(0,y.useEffect)(function(){return ra||(Ri(),ra=!0),e.registerCommand(s.m$,function(n){var a=(0,s.dL)();return(0,s.OP)(a)&&na+Oi>n.timeStamp&&(0,s.oq)(a.clone()),!1},Mi)},[e]),null}var ji=S(98439),Di=33,Pi=50;function Ii(r){var t=r.editor,e=(0,y.useRef)(null),n=(0,y.useRef)(null),a=(0,y.useRef)(null),o=(0,y.useRef)(null),l=(0,y.useState)(null),f=M()(l,2),v=f[0],d=f[1],m=(0,y.useState)(null),g=M()(m,2),c=g[0],u=g[1],h=(0,y.useState)(!1),p=M()(h,2),C=p[0],N=p[1],E=(0,y.useState)(null),b=M()(E,2),k=b[0],w=b[1],x=(0,y.useCallback)(function(){u(null),e.current=null,w(null),o.current=null,a.current=null},[]),T=function($){return($.buttons&1)===1};(0,y.useEffect)(function(){var H=function(_){setTimeout(function(){var G=_.target;if(k){d({x:_.clientX,y:_.clientY});return}if(N(T(_)),!(n.current&&n.current.contains(G))&&e.current!==G){e.current=G;var Z=Gt(G);Z&&c!==Z?t.update(function(){var ee=(0,s.Xo)(Z.elem);if(!ee)throw new Error("TableCellResizer: Table cell node not found.");var re=St(ee),me=t.getElementByKey(re.getKey());if(!me)throw new Error("TableCellResizer: Table element not found.");e.current=G,a.current=me.getBoundingClientRect(),u(Z)}):Z===null&&x()}},0)},$=function(){setTimeout(function(){N(!0)},0)},z=function(){setTimeout(function(){N(!1)},0)},j=t.registerRootListener(function(F,_){F==null||F.addEventListener("mousemove",H),F==null||F.addEventListener("mousedown",$),F==null||F.addEventListener("mouseup",z),_==null||_.removeEventListener("mousemove",H),_==null||_.removeEventListener("mousedown",$),_==null||_.removeEventListener("mouseup",z)});return function(){j()}},[c,k,t,x]);var O=function($){return $==="bottom"},L=function($,z){var j=z.getElementByKey($.getKey());return j==null?void 0:j.clientHeight},R=(0,y.useCallback)(function(H){if(!c)throw new Error("TableCellResizer: Expected active cell.");t.update(function(){var $=(0,s.Xo)(c.elem);if(!W($))throw new Error("TableCellResizer: Table cell node not found.");var z=St($),j=Wn($),F=z.getChildren();if(j>=F.length||j<0)throw new Error("Expected table cell to be inside of table row.");var _=F[j];if(!de(_))throw new Error("Expected table row");var G=_.getHeight();if(G===void 0){var Z=_.getChildren();G=Math.min.apply(Math,ze()(Z.map(function(re){var me;return(me=L(re,t))!==null&&me!==void 0?me:1/0})))}var ee=Math.max(G+H,Di);_.setHeight(ee)},{tag:"skip-scroll-into-view"})},[c,t]),A=function($,z){var j=$.getWidth();if(j!==void 0)return j;var F=z.getElementByKey($.getKey());if(F!==null){var _=getComputedStyle(F);return F.clientWidth-parseFloat(_.paddingLeft)-parseFloat(_.paddingRight)}},K=function($,z){for(var j=0;j<z.length;j++)for(var F=0;F<z[j].length;F++)if(z[j][F].cell===$)return F},B=(0,y.useCallback)(function(H){if(!c)throw new Error("TableCellResizer: Expected active cell.");t.update(function(){var $=(0,s.Xo)(c.elem);if(!W($))throw new Error("TableCellResizer: Table cell node not found.");var z=St($),j=Zt(z,null,null),F=M()(j,1),_=F[0],G=K($,_);if(G===void 0)throw new Error("TableCellResizer: Table column not found.");for(var Z=0;Z<_.length;Z++){var ee=_[Z][G];if(ee.startRow===Z&&(G===_[Z].length-1||_[Z][G].cell!==_[Z][G+1].cell)){var re=A(ee.cell,t);if(re===void 0)continue;var me=Math.max(re+H,Pi);ee.cell.setWidth(me)}}},{tag:"skip-scroll-into-view"})},[c,t]),P=(0,y.useCallback)(function(H){var $=function z(j){if(j.preventDefault(),j.stopPropagation(),!c)throw new Error("TableCellResizer: Expected active cell.");if(o.current){var F=o.current,_=F.x,G=F.y;if(c===null)return;var Z=(0,D.MZ)(j.target);if(O(H)){var ee=(j.clientY-G)/Z;R(ee)}else{var re=(j.clientX-_)/Z;B(re)}x(),document.removeEventListener("mouseup",z)}};return $},[c,x,B,R]),I=(0,y.useCallback)(function(H){return function($){if($.preventDefault(),$.stopPropagation(),!c)throw new Error("TableCellResizer: Expected active cell.");o.current={x:$.clientX,y:$.clientY},d(o.current),w(H),document.addEventListener("mouseup",P(H))}},[c,P]),U=(0,y.useCallback)(function(){if(c){var H=c.elem.getBoundingClientRect(),$=H.height,z=H.width,j=H.top,F=H.left,_=(0,D.MZ)(c.elem),G=10,Z={bottom:{backgroundColor:"none",cursor:"row-resize",height:"".concat(G,"px"),left:"".concat(window.pageXOffset+F,"px"),top:"".concat(window.pageYOffset+j+$-G/2,"px"),width:"".concat(z,"px")},right:{backgroundColor:"none",cursor:"col-resize",height:"".concat($,"px"),left:"".concat(window.pageXOffset+F+z-G/2,"px"),top:"".concat(window.pageYOffset+j,"px"),width:"".concat(G,"px")}},ee=a.current;return k&&v&&ee&&(O(k)?(Z[k].left="".concat(window.pageXOffset+ee.left,"px"),Z[k].top="".concat(window.pageYOffset+v.y/_,"px"),Z[k].height="3px",Z[k].width="".concat(ee.width,"px")):(Z[k].top="".concat(window.pageYOffset+ee.top,"px"),Z[k].left="".concat(window.pageXOffset+v.x/_,"px"),Z[k].width="3px",Z[k].height="".concat(ee.height,"px")),Z[k].backgroundColor="#aaddff"),Z}return{bottom:null,left:null,right:null,top:null}},[c,k,v]),X=U();return(0,i.jsx)("div",{ref:n,children:c!==null&&!C&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"table-cell-resizer-resizer TableCellResizer__ui",style:X.right||void 0,onMouseDown:I("right")}),(0,i.jsx)("div",{className:"table-cell-resizer-resizer TableCellResizer__ui",style:X.bottom||void 0,onMouseDown:I("bottom")})]})})}function oa(){var r=(0,Te.g)(),t=M()(r,1),e=t[0],n=(0,ji.P)();return(0,y.useMemo)(function(){return n?(0,Ue.createPortal)((0,i.jsx)(Ii,{editor:e}),document.body):null},[e,n])}var Ai=S(1228),Bi=S(29547),et=S(75875),Fi=S(19517),ia=S(39552),la=S(73659),on=S(57442),_i=function(t){var e=t.disabled,n=t.color,a=t.onChange;return(0,i.jsx)(ia.Z,{value:n,destroyTooltipOnHide:!0,size:"small",styles:{popupOverlayInner:{width:480}},onChangeComplete:function(l){a(l.toHexString())},presets:[{label:"greyDark",colors:et.gt},{label:"red",colors:et.Q6},{label:"blue",colors:et.iN},{label:"green",colors:et.ek}],panelRender:function(l,f){var v=f.components,d=v.Picker,m=v.Presets;return(0,i.jsxs)(la.Z,{justify:"space-between",wrap:!1,children:[(0,i.jsx)(on.Z,{span:12,children:(0,i.jsx)(m,{})}),(0,i.jsx)(Kt.Z,{type:"vertical",style:{height:"auto"}}),(0,i.jsx)(on.Z,{flex:"auto",children:(0,i.jsx)(d,{})})]})},children:(0,i.jsx)(ne,{toolTip:"\u80CC\u666F\u989C\u8272",disabled:e,icon:(0,i.jsx)(Fi.Z,{})})})},$i=function(t){var e,n=t.editor,a=t.value,o=t.disabled,l=o===void 0?!1:o,f=(0,y.useState)(!1),v=M()(f,2),d=v[0],m=v[1],g=function(h){m(h)},c=function(h){m(!1),n.dispatchCommand(s.RO,h)};return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(Je.Z,{placement:"bottomLeft",overlayInnerStyle:{padding:"0px"},arrow:!1,open:d,onOpenChange:g,content:(0,i.jsx)("div",{className:"drum-dropdown-content",children:Object.keys(an).map(function(u,h){return(0,i.jsxs)("div",{className:"drum-dropdown-item ".concat(a===u?"active":""),onClick:function(){c(u)},children:[(0,i.jsxs)("div",{children:[an[u].icon," ",(0,i.jsx)("span",{children:an[u].name})]}),a===u&&(0,i.jsx)(Ve.Z,{})]},h)})}),trigger:"click",children:(0,i.jsxs)(ye.ZP,{disabled:!!l,type:"text",onClick:function(){m(!d)},children:[(0,i.jsxs)("div",{style:{width:"10px",textAlign:"left"},children:[a?(e=an[a])===null||e===void 0?void 0:e.icon:""," "]}),(0,i.jsx)(nt.Z,{})]})})})},Hi=S(55332),Ki=function(t){var e=t.disabled,n=t.color,a=t.onChange;return(0,i.jsx)(ia.Z,{value:n,destroyTooltipOnHide:!0,size:"small",styles:{popupOverlayInner:{width:480}},onChangeComplete:function(l){a(l.toHexString())},presets:[{label:"greyDark",colors:et.gt},{label:"red",colors:et.Q6},{label:"blue",colors:et.iN},{label:"green",colors:et.ek}],panelRender:function(l,f){var v=f.components,d=v.Picker,m=v.Presets;return(0,i.jsxs)(la.Z,{justify:"space-between",wrap:!1,children:[(0,i.jsx)(on.Z,{span:12,children:(0,i.jsx)(m,{})}),(0,i.jsx)(Kt.Z,{type:"vertical",style:{height:"auto"}}),(0,i.jsx)(on.Z,{flex:"auto",children:(0,i.jsx)(d,{})})]})},children:(0,i.jsx)(ne,{toolTip:"\u5B57\u4F53\u989C\u8272",disabled:e,icon:(0,i.jsx)(Hi.Z,{})})})},zi=function(t){var e=t.editor,n=t.disabled,a=t.value,o=(0,y.useState)(!1),l=M()(o,2),f=l[0],v=l[1],d=function(c){v(c)},m=y.useCallback(function(g){v(!1),e.update(function(){if(e.isEditable()){var c=(0,s.dL)();c!==null&&(0,ve.yD)(c,{"font-size":g})}})},[e]);return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(Je.Z,{placement:"bottomLeft",overlayInnerStyle:{padding:"0px"},arrow:!1,open:f,onOpenChange:d,content:(0,i.jsx)("div",{className:"drum-dropdown-content",style:{width:"100px"},children:Object.keys(qr).map(function(g,c){return(0,i.jsxs)("div",{className:"drum-dropdown-item ".concat(a===g?"active":""),onClick:function(){m(g)},children:[(0,i.jsx)("span",{children:qr[g].name}),a===g&&(0,i.jsx)(Ve.Z,{})]},c)})}),trigger:"click",children:(0,i.jsxs)(ye.ZP,{disabled:!!n,type:"text",onClick:function(){v(!f)},children:[(0,i.jsx)("div",{style:{width:"35px",textAlign:"left"},children:a}),(0,i.jsx)(nt.Z,{})]})})})};function Ui(){for(var r=[],t=0,e=Object.entries(J.Wq);t<e.length;t++){var n=M()(e[t],2),a=n[0],o=n[1];r.push([a,o])}return r}var Wi=Ui(),sa=function(t){var e,n=t.setIsLinkEditMode,a=(0,Te.g)(),o=M()(a,1),l=o[0],f=(0,y.useState)(function(){return l.isEditable()}),v=M()(f,2),d=v[0],m=v[1],g=(0,y.useState)(l),c=M()(g,2),u=c[0],h=c[1],p=(0,y.useState)(!1),C=M()(p,2),N=C[0],E=C[1],b=(0,y.useState)(!1),k=M()(b,2),w=k[0],x=k[1],T=(0,y.useState)("paragraph"),O=M()(T,2),L=O[0],R=O[1],A=(0,y.useState)(null),K=M()(A,2),B=K[0],P=K[1],I=(0,y.useState)(!1),U=M()(I,2),X=U[0],H=U[1],$=(0,y.useState)(!1),z=M()($,2),j=z[0],F=z[1],_=(0,y.useState)(!1),G=M()(_,2),Z=G[0],ee=G[1],re=(0,y.useState)(!1),me=M()(re,2),Ne=me[0],je=me[1],De=(0,y.useState)(!1),we=M()(De,2),Le=we[0],xe=we[1],Me=(0,y.useState)(!1),tt=M()(Me,2),wt=tt[0],Fe=tt[1],At=(0,y.useState)(!1),ut=M()(At,2),ln=ut[0],An=ut[1],Bn=(0,y.useState)(!1),Bt=M()(Bn,2),ct=Bt[0],sn=Bt[1],Fn=(0,y.useState)(""),kt=M()(Fn,2),Ft=kt[0],_t=kt[1],un=(0,y.useState)("left"),cn=M()(un,2),dn=cn[0],dt=cn[1],Zi=(0,y.useState)("#000000"),ua=M()(Zi,2),Xi=ua[0],Gi=ua[1],Yi=(0,y.useState)("#ffffff"),ca=M()(Yi,2),Vi=ca[0],Ji=ca[1],Qi=(0,y.useState)("15px"),da=M()(Qi,2),qi=da[0],el=da[1],Nt=(0,y.useCallback)(function(){var Y=(0,s.dL)();if((0,s.OP)(Y)){H(Y.hasFormat("bold")),F(Y.hasFormat("italic")),ee(Y.hasFormat("underline")),je(Y.hasFormat("code")),xe(Y.hasFormat("subscript")),Fe(Y.hasFormat("superscript")),An(Y.hasFormat("strikethrough"));var ae=Et(Y),ke=ae.getParent();(0,Q.Pq)(ke)||(0,Q.Pq)(ae)?sn(!0):sn(!1);var _e=Y.anchor.getNode(),Pe=_e.getKey()==="root"?_e:(0,D.$s)(_e,function(hn){var va=hn.getParent();return va!==null&&(0,s._v)(va)});Pe===null&&(Pe=_e.getTopLevelElementOrThrow());var $e=Pe.getKey(),vn=u.getElementByKey($e);if(vn!==null){if(P($e),(0,te.I3)(Pe)){var Se=(0,D.yD)(_e,te.EG),mn=Se?Se.getListType():Pe.getListType();R(mn)}else{var fa=(0,ce.rc)(Pe)?Pe.getTag():Pe.getType();if(fa in Ge&&R(fa),(0,J.Pe)(Pe)){var _n=Pe.getLanguage();_t(_n?J.md[_n]||_n:"");return}}var $n;(0,Q.Pq)(ke)&&($n=(0,D.$s)(ae,function(hn){return(0,s.F7)(hn)&&!hn.isInline()})),Gi((0,ve.ui)(Y,"color","#000000")),Ji((0,ve.ui)(Y,"background-color","#fff")),dt((0,s.F7)($n)?$n.getFormatType():(0,s.F7)(ae)?ae.getFormatType():(ke==null?void 0:ke.getFormatType())||"left")}}((0,s.OP)(Y)||le(Y))&&el((0,ve.ui)(Y,"font-size","15px"))},[u,l]);(0,y.useEffect)(function(){return l.registerCommand(s.oj,function(Y,ae){return h(ae),Nt(),!1},s.jw)},[l,Nt]),(0,y.useEffect)(function(){u.getEditorState().read(function(){Nt()})},[u,Nt]),(0,y.useEffect)(function(){return(0,D.qV)(l.registerEditableListener(function(Y){m(Y)}),u.registerUpdateListener(function(Y){var ae=Y.editorState;ae.read(function(){Nt()})}),u.registerCommand(s.yn,function(Y){return E(Y),!1},s.jw),u.registerCommand(s.r0,function(Y){return x(Y),!1},s.jw))},[Nt,u,l]);var tl=(0,y.useCallback)(function(){ct?(n(!1),u.dispatchCommand(Q.k0,null)):(n(!0),u.dispatchCommand(Q.k0,In("https://")))},[u,ct,n]),nl=(0,y.useCallback)(function(Y){u.update(function(){if(B!==null){var ae=(0,s.gI)(B);(0,J.Pe)(ae)&&ae.setLanguage(Y)}})},[u,B]),fn=(0,y.useCallback)(function(Y,ae){u.update(function(){var ke=(0,s.dL)();ke!==null&&(0,ve.yD)(ke,Y)},ae?{tag:"historic"}:{})},[u]),rl=(0,y.useCallback)(function(Y,ae){fn({color:Y},ae)},[fn]),al=(0,y.useCallback)(function(Y,ae){fn({"background-color":Y},ae)},[fn]),ol=(0,y.useCallback)(function(){u.update(function(){var Y=(0,s.dL)();if((0,s.OP)(Y)||le(Y)){var ae=Y.anchor,ke=Y.focus,_e=Y.getNodes(),Pe=Y.extract();if(ae.key===ke.key&&ae.offset===ke.offset)return;_e.forEach(function($e,vn){if((0,s.Gg)($e)){var Se=$e;vn===0&&ae.offset!==0&&(Se=Se.splitText(ae.offset)[1]||Se),vn===_e.length-1&&(Se=Se.splitText(ke.offset)[0]||Se);var mn=Pe[0];_e.length===1&&(0,s.Gg)(mn)&&(Se=mn),Se.__style!==""&&Se.setStyle(""),Se.__format!==0&&(Se.setFormat(0),(0,D.f8)(Se).setFormat("")),$e=Se}else(0,ce.rc)($e)||(0,ce.O)($e)?$e.replace((0,s.BE)(),!0):(0,Bi.F)($e)&&$e.setFormat("")})}})},[u]);return(0,i.jsxs)("div",{className:"drum-toolbar",children:[(0,i.jsx)(ne,{icon:(0,i.jsx)(ue,{type:"icon-undo"}),toolTip:"\u64A4\u9500".concat(D.jB?" (\u2318 Z)":" (Ctrl+Z)"),disabled:!N||!d,onClick:function(){u.dispatchCommand(s.$l,void 0)}}),(0,i.jsx)(ne,{icon:(0,i.jsx)(ue,{type:"icon-redo"}),toolTip:"\u91CD\u505A".concat(D.jB?" (\u2318 Y)":" (Ctrl+Y)"),disabled:!w||!d,onClick:function(){u.dispatchCommand(s.zq,void 0)}}),(0,i.jsx)(ne,{icon:(0,i.jsx)(ue,{type:"icon-xiangpica"}),toolTip:"\u6E05\u9664\u683C\u5F0F",onClick:ol}),(0,i.jsx)(at,{}),L in Ge&&u===l&&(0,i.jsx)(ea,{editor:u,buttonLabel:(e=Ge[L])===null||e===void 0?void 0:e.name,disabled:!d,blockType:L}),L==="code"?(0,i.jsx)(pn,{disabled:!d,buttonLabel:(0,J.zP)(Ft),activeOption:Ft,options:Wi.map(function(Y){var ae=M()(Y,2),ke=ae[0],_e=ae[1];return{label:_e,value:ke}}),onChange:function(ae){nl(ae)}}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(zi,{editor:u,disabled:!d,value:qi}),(0,i.jsx)(ne,{disabled:!d,icon:(0,i.jsx)(Gr.Z,{}),toolTip:"\u52A0\u7C97".concat(D.jB?" (\u2318 B)":" (Ctrl+B)"),active:X,onClick:function(){u.dispatchCommand(s.Ew,"bold")}}),(0,i.jsx)(ne,{disabled:!d,icon:(0,i.jsx)(Yr.Z,{}),toolTip:"\u659C\u4F53".concat(D.jB?" (\u2318 I)":" (Ctrl+I)"),active:j,onClick:function(){u.dispatchCommand(s.Ew,"italic")}}),(0,i.jsx)(ne,{disabled:!d,icon:(0,i.jsx)(Vr.Z,{}),toolTip:"\u4E0B\u5212\u7EBF".concat(D.jB?" (\u2318 U)":" (Ctrl+U)"),active:Z,onClick:function(){u.dispatchCommand(s.Ew,"underline")}}),(0,i.jsx)(ne,{disabled:!d,icon:(0,i.jsx)(Jr.Z,{}),toolTip:"\u5220\u9664\u7EBF",active:ln,onClick:function(){u.dispatchCommand(s.Ew,"strikethrough")}}),(0,i.jsx)(ne,{disabled:!d,icon:(0,i.jsx)(ue,{type:"icon-code-view"}),toolTip:"\u884C\u5185\u4EE3\u7801",active:Ne,onClick:function(){u.dispatchCommand(s.Ew,"code")}}),(0,i.jsx)(ne,{disabled:!d,icon:(0,i.jsx)(ue,{type:"icon-superscript"}),toolTip:"\u4E0A\u6807",active:wt,onClick:function(){u.dispatchCommand(s.Ew,"superscript")}}),(0,i.jsx)(ne,{disabled:!d,icon:(0,i.jsx)(ue,{type:"icon-subscript"}),toolTip:"\u4E0B\u6807",active:Le,onClick:function(){u.dispatchCommand(s.Ew,"subscript")}}),(0,i.jsx)(at,{}),(0,i.jsx)(Ki,{disabled:!d,color:Xi,onChange:rl}),(0,i.jsx)(_i,{disabled:!d,color:Vi,onChange:al}),(0,i.jsx)(at,{}),(0,i.jsx)($i,{editor:u,disabled:!d,value:dn||"left"}),(0,i.jsx)(ne,{disabled:!d,icon:(0,i.jsx)(ue,{type:"icon-indent-increase"}),toolTip:"\u589E\u52A0\u7F29\u8FDB",onClick:function(){l.dispatchCommand(s.PU,void 0)}}),(0,i.jsx)(ne,{disabled:!d,icon:(0,i.jsx)(ue,{type:"icon-indent-increase"}),toolTip:"\u51CF\u5C11\u7F29\u8FDB",onClick:function(){l.dispatchCommand(s.cz,void 0)}}),(0,i.jsx)(at,{}),(0,i.jsx)(Or,{editor:u,disabled:!d}),(0,i.jsx)(Sn,{disabled:!d,editor:u,children:(0,i.jsx)(ne,{disabled:!d,icon:(0,i.jsx)(Lr.Z,{}),toolTip:"\u56FE\u7247"})}),(0,i.jsx)(ne,{disabled:!d,icon:(0,i.jsx)(Qr.Z,{}),toolTip:"\u94FE\u63A5",active:ct,onClick:tl}),(0,i.jsx)(ne,{disabled:!d,icon:(0,i.jsx)(Ai.Z,{}),toolTip:"\u5206\u5272\u7EBF",onClick:function(){u.dispatchCommand(Ie.qL,void 0)}})]})]})}},16:function(ft,he,S){S.r(he),S.d(he,{texts:function(){return Q}});var J=S(24072);const Q=[{value:"npm",paraId:0,tocIndex:0},{value:`npm install @lxzmo/drum
`,paraId:1,tocIndex:0},{value:"pnpm",paraId:2,tocIndex:0},{value:`pnpm install @lxzmo/drum
`,paraId:3,tocIndex:0},{value:"yarn",paraId:4,tocIndex:0},{value:`yarn add @lxzmo/drum
`,paraId:5,tocIndex:0}]},29576:function(ft,he,S){S.r(he),S.d(he,{texts:function(){return Q}});var J=S(81861);const Q=[]},61651:function(ft,he,S){S.r(he),S.d(he,{texts:function(){return Q}});var J=S(26037);const Q=[]}}]);
